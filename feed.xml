<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ivan Grishaev's blog</title>
    <description>Writing on programming, education, books and negotiations.
</description>
    <link>https://grishaev.me/</link>
    <atom:link href="https://grishaev.me/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 24 Oct 2024 19:21:51 +0000</pubDate>
    <lastBuildDate>Thu, 24 Oct 2024 19:21:51 +0000</lastBuildDate>
    <generator>Jekyll v4.2.0</generator>
    
      <item>
        <title>Механическая работа</title>
        <description>&lt;p&gt;Любую работу я условно делю на осмысленную и механическую. Первая — когда нужно
думать, вторая — когда не нужно. Если проще, то в первом случае работает голова
— нужно соображать, искать варианты. Во втором случае — задница: нужно сесть и
сделать монотонную работу.&lt;/p&gt;

&lt;p&gt;Каждый вид хорош по-своему, и секрет в том, как их чередовать.&lt;/p&gt;

&lt;p&gt;Механическую работу нельзя делать, пока остался потенциал для осмысленной. Лучше
сделать осмысленную, а механическую оставить на потом. Обратное тоже верно:
нельзя браться за осмысленную, если уже устал — лучше заняться рутиной.&lt;/p&gt;

&lt;p&gt;Например, мы исследуем узкое место в программе. Это осмысленная работа, потому
что нужно строить гипотезы и проверять их. Предположим, мы нашли причину, и
теперь нужно исправить двадцать файлов. Это механическая работа, и будет глупо
браться за нее сразу — наверняка остался потенциал для чего-то полезного. Лучше
исправить пару файлов и поскорее прогнать замеры. Нафигачить костылей, выкатить
приложение на препрод и посмотреть метрики. И только если гипотеза
подтвердилась, прижать зад и исправить остальные 18 файлов.&lt;/p&gt;

&lt;p&gt;Я не чураюсь механической работы. Просто отмечаю про себя, что это место в целом
понятно, просто нужно взять его терпением. И возвращаюсь, когда мозги уже
выжаты, а работают только пальцы. Я не особо люблю автоматизирующие скрипты —
писать и отлаживать их дольше, чем сделать работу. Включаю что-нибудь из раннего
Пинк Флойд и колбашу руками.&lt;/p&gt;

&lt;p&gt;Осмысленность и механика — две стороны одной медали. На самом деле одно и то же,
но и разные. Дают гибкость и маневр, скрашивают капризы нашего тела.&lt;/p&gt;
</description>
        <pubDate>Tue, 22 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/mech-work/</link>
        <guid isPermaLink="true">https://grishaev.me/mech-work/</guid>
        
        <category>programming</category>
        
        <category>work</category>
        
        
      </item>
    
      <item>
        <title>Крайний</title>
        <description>&lt;p&gt;&lt;img src=&quot;/assets/static/aws/kray/1.jpeg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;К слову “крайний” в значении “последний” я отношусь с улыбкой. Это дремучее
просторечие, и дергать людей из-за него — то же самое, что поправлять “одеть” и
“надеть”. Пусть человек говорит, такая у него особенность.&lt;/p&gt;

&lt;p&gt;Но я никогда не думал, что прочту “крайний” в значении “последний” в книге. И не
в прямой речи простолюдина, скажем, “братан, предупреждаю, это крайний
раз”. Слово “крайний” использует рассказчик книги, по сюжету — развитый,
интеллектуальный персонаж.&lt;/p&gt;

&lt;p&gt;Как же случилось, что такое просторечение пропустили переводчик, корректор и
редактор? Это уму не постижимо — разве что все трое приехали из одной рязанской
деревни. Другой версии у меня нет.&lt;/p&gt;

&lt;p&gt;Книга — “Звездный десант”, &lt;em&gt;крайний&lt;/em&gt; перевод.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UPD:&lt;/strong&gt; в Телеграме объяснили, что “крайний” пришло из военных и прочих
профессий, связанных с риском. Там не говорят “последний раз”, опасаясь, что он
станет таковым буквально. Можно понять: у военных, моряков и летчиков целый
букет прибабахов. Но зачем перенимать это в обычную жизнь – загадка.&lt;/p&gt;
</description>
        <pubDate>Tue, 22 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/kray/</link>
        <guid isPermaLink="true">https://grishaev.me/kray/</guid>
        
        <category>books</category>
        
        
      </item>
    
      <item>
        <title>Задача с датами</title>
        <description>&lt;p&gt;Прочитал, что в одной фирме дают задание: не используя библиотеки и Гугл,
написать функцию, которая для заданной даты вернет название дня. Скажем, для
2021-03-25 — вторник, для 2015-09-11 — среду (беру с потолка). Я бы эту задачу
не решил, и вот почему.&lt;/p&gt;

&lt;p&gt;Во-первых, я не помню все критерии високосного года. Каждый четвертый — это
понятно, но есть еще два критерия, которые встречаются реже. Нужно смотреть их в
википедии.&lt;/p&gt;

&lt;p&gt;Во-вторых, я не помню, сколько дней в каком месяце за исключением февраля. В
детском саду и школе нас учили считать по костяшкам, но на мой взгляд, это
бред. Костяшек восемь, месяцев двенадцать. Если брать одну руку, то костяшек
четыре, а промежутков три, в сумме семь. Как ни крути, эта сова не натягивается.&lt;/p&gt;

&lt;p&gt;В-третьих, нужна точка отсчета. Даже если я переведу дату в число дней и возьму
остаток от деления на семь, нужно знать, какой день был первым. Считается, что
Иисус родился в понедельник? В любом случае это нужно сверять с википедией.&lt;/p&gt;

&lt;p&gt;Еще был переход с юлианского календаря на григорианский, отсюда “старый стиль”,
“старый новый год” и прочее.&lt;/p&gt;

&lt;p&gt;Наконец, текущая система дат и времени — это костыль на костыле, которые
достались нам от древних греков. Самое худшее, что можно вообразить — это
работать с датами без библиотеки.&lt;/p&gt;

&lt;p&gt;“Что ж, свою кандидатуру я снимаю сам.” ©&lt;/p&gt;

&lt;p&gt;А вы бы решили?&lt;/p&gt;
</description>
        <pubDate>Tue, 22 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/date-task/</link>
        <guid isPermaLink="true">https://grishaev.me/date-task/</guid>
        
        <category>programming</category>
        
        <category>date</category>
        
        
      </item>
    
      <item>
        <title>Еще про Silent Hill 2</title>
        <description>&lt;p&gt;Еще одна заметка про Silent Hill. Понимаю, что всем пофиг, но это для себя. В
этот раз — еще одна партия наблюдений, незамеченных в детстве.&lt;/p&gt;

&lt;p&gt;Как вы знаете, герой ищет пропавшую жену Мэри. Город знакомит его с Марией —
женщиной, которая выглядит как жена, но противоположна ей по характеру:
общительна, сексуально раскрепощена. Часть локаций Джеймс проходит с Марией, у
нее есть ключи от закрытых дверей.&lt;/p&gt;

&lt;p&gt;Во второй половине игры происходят странные вещи: Марию начинают убивать, причем
каждый раз с большей жестокостью. В первый раз ее пронзает ножом Пирамида, во
второй раз Джеймс находит ее истерзанной в тюрьме, в третий раз ее казнят
кольями. Каждый случай Джеймс переживает все тяжелее, и это расшатывает его
рассудок. Примечательно, что после смерти Мария ничего не помнит и ведет
разговор о посторонних вещах.&lt;/p&gt;

&lt;p&gt;Не монстры, не ужасы города, а именно Мария становится главным мучением
Джеймса. В каждой ее смерти он винит себя. Это напоминает наказание в аду, когда
преступник переживает преступление снова и снова. Вот в чем заключается
наказание Джеймса: город дает ему идеальную женщину и постоянно убивает ее,
сводя с ума.&lt;/p&gt;

&lt;p&gt;Только в последней сцене, увидев Марию живой в четвертый раз, Джеймс отвергает
ее. Этим он разрывает порочный круг, и начинается финал.&lt;/p&gt;

&lt;p&gt;Другой сложный символ, который сопровождает игру — это кровать, и появляется он
в двух значениях. Первый — медленный уход из жизни, когда человек проводит дни в
страданиях. Кровать становится его тюрьмой, превращаясь в могилу. Пустая кровать
появляется, когда речь идет об умершей жене. Пустые кровати часто встречаются в
игре как немой упрек: раньше здесь был человек, а теперь его нет.&lt;/p&gt;

&lt;p&gt;Второе значение кровати — страсть, секс. Кровать встречается в сценах с Марией,
альтер-эго умершей жены. Иногда Мария ложится якобы отдохнуть, взглядом и жестом
приглашая Джеймса занять место рядом. После первого убийства Джеймс находит
Марию в тюрьме в комнате длительных свиданий — проще говоря, месте, отведенном
для секса. Мария сидит на кровати за решеткой, и нужно найти к ней другой
путь. Когда Джеймс отправляется на поиски хода, она откидывается назад, намекая,
какой будет встреча.&lt;/p&gt;

&lt;p&gt;Когда Джеймс приходит к ней подземным ходом, Мария оказывается убитой. Шокирует
резкая смена контекста: еще недавно она лежала на кровати соблазняя, а теперь
лежит, будучи жертвой. Такой быстрый переход от любви к смерти подействовал на
меня сильно. В детстве я не оценил мощь этой перемены, видимо, я просто не
мог. С возрастом появились какие-то струнки, которые теперь задеты.&lt;/p&gt;

&lt;p&gt;Интересный факт насчет трех лет. Джеймс утверждает, что жена умерла три года
назад. Он продолжает это делать даже когда вылазят зловещие нестыковки. Ближе к
концу мы узнаем, откуда взялись эти три года. В лодочной станции есть магнитофон
с записями диспетчеров. Если послушать их, послышится диалог Джеймса с доктором
в госпитале. Джеймс пытается выжать из доктора, сколько осталось жене. Доктор
дает крайне широкую оценку: возможно, три года, возможно, несколько месяцев. И
хотя все произошло за неделю, ум Джеймса ухватился за эти три года, стараясь
задвинуть трагедию как можно дальше в прошлое.&lt;/p&gt;

&lt;p&gt;Сексуализация монстров, которые выглядят как женские фигуры, связана с
подавленным желанием Джеймса. В игре не обсуждается его сексуальная жизнь, но
судя по долгому угасанию жены, в ней значительный пробел. Навещая жену в
госпитале, Джеймс смотрел на ноги и грудь медсестер — в основном из этих частей
состоят монстры. В середине игры есть сцена, где обыграно изнасилование одного
из существ. Очевидно, это фантазии Джеймса.&lt;/p&gt;

&lt;p&gt;Каждый персонаж живет в своем мире, и только изредка они пересекаются. Каждому
предназначено свое мучение. Об этом не сказано явно, нужно догадаться из
диалогов. Когда Джеймс видит Анжелу в последний раз, он замечает, что все в огне
(намек на то, что Анжела сожгла дом вместе с насильником). На это Анжела
отвечает, что “для нее всегда так”. Неудачника Эдди преследуют выдуманные им же
люди, которые насмехаются над ним. Джеймс не видит этих людей, потому что они в
мире Эдди. Пересекаясь с ним, он видит только трупы убитых насмешников. В мире
Лоры нет ни монстров, ни опасностей, только кошки. Догадаться об этом можно по
диалогу, когда Джеймс находит Лору в подвале госпиталя и спрашивает, как есть
удалось не получить ни царапины. Лора искренне не понимает, что ей может
угрожать.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Много всего я надумал, ненадолго вернувшись к этой игре. Ощущение, что
перечитываешь Достоевского или Булгакова — нет-нет да найдешь то, что раньше не
замечал. Может быть, через пятнадцать лет еще что-то найду — и разумеется, дам
вам знать.&lt;/p&gt;
</description>
        <pubDate>Fri, 18 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/sh2-more/</link>
        <guid isPermaLink="true">https://grishaev.me/sh2-more/</guid>
        
        <category>games</category>
        
        <category>silent-hill</category>
        
        <category>ost</category>
        
        
      </item>
    
      <item>
        <title>Саундтрек из Silent Hill 2</title>
        <description>
&lt;p&gt;Один знакомый, зная, что я неравнодушен к серии Silent Hill, прислал ссылку на
саундтрек ремастера. Оказалось, это не полноценный саундтрек, а нарезка по 20
секунд из каждого трека. Но поскольку там 90 треков длительностью три часа,
сумма огрызков набегает на час. &lt;a href=&quot;https://ixbt.games/news/2024/10/01/konami-nagnetaet-atmosferu-v-preddverii-vyxoda-silent-hill-2-remake-otryvki-iz-obnovlennogo-saundtre.html&quot;&gt;Послушайте и вы по ссылке.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Вдохновившись музыкой, пересмотрел ключевые сцены из оригинальной второй
части. Лишний раз убедился, что Silent Hill 2 — уникальная в своем роде
игра. Другой такой нет, да и не нужно — пусть она останется неповторимой.&lt;/p&gt;

&lt;p&gt;Дело в том, что в основе игры лежит глубокая личная драма заурядного
человека. Главный герой Джеймс не спасает мир от монстров и не ищет волшебные
артефакты. Его проблема — медленный уход из жизни близкого человека. Боль,
борьба желания и долга, терзания, что сказать и сделать в ситуации, когда и то,
и другое бесполезно.&lt;/p&gt;

&lt;p&gt;Пересматривая кат-сцены, не переставал удивляться глубокому символизму
игры. Каждый кадр, каждая сцена выстроена так, чтобы сообщать что-то между
строк. Это и окружающие предметы, и антураж, и одежда героев.&lt;/p&gt;

&lt;p&gt;Красной нитью сквозь игру идет тема суда — подавленное желание наказать себя за
преступление. Это преступление тщательно забыто, но прорывается наружу
флешбеками и уликами. Темы суда и казни особенно сильны в конце, когда герой
поднимается на крышу по железному коридору. Формально железные ограждения нужны,
чтобы человек не упал с лестницы, но на самом деле это отсылка к тюремному
коридору, по которому заключенный идет к месту казни. Когда Джеймс ступает на
крышу, коридор падает — обратно он не вернется.&lt;/p&gt;

&lt;p&gt;Другой назойливый символ игры — нож. В меню игры его форму имеет курсор. Нож
передает Джеймсу Анжела. Оружие Пирамиды есть увеличенный в размерах нож — тот
самый, что носит Джеймс. Его гротескный размер, вероятно, имеет отсылку к
картинам Сальвадора Дали, где гигантизм означает дутую немощь.&lt;/p&gt;

&lt;p&gt;Ближе к концу игры Анжела просит отдать нож: она хочет покончить с собой, чтобы
избежать мучений. Джеймс отказывается, на что Анжела замечает: бережешь для
себя? И хотя Джеймс несколько раз за игру произносит, что не убил бы себя,
именно это случается в главной концовке. Я в курсе, что есть и другие, в том
числе когда он уходит из города с новой женщиной, а в лучшем случае — даже с
ребенком. Но получить хорошую концовку при первом прохождении, скажем мягко,
затруднительно. Поэтому суицидальный конец истории я считаю каноничным.&lt;/p&gt;

&lt;p&gt;Завершение самоубийством по-своему хорошо тем, что вписывается в концепцию
игры. Она становится абсолютно, полностью завершенной. Дело в том, что игра
начинается на парковке возле пристани. Оттуда Джеймс начинает путешествие в
город. На парковке стоит его машина. При попытке открыть багажник Джеймс
говорит, что почему-то хочет этого делать — в то время как взять вещи из машины,
казалось бы, самое логичное дело.&lt;/p&gt;

&lt;p&gt;Здесь и таится главная недосказанность игры: в багажнике машины лежит тело его
жены. Повидав ужасы города, лишенный всех надежд Джеймс, пережив смерть жены
дважды, возвращается на парковку. Там он заводит автомобиль и топит себя с телом
жены. Не все из этого показано в игре, но концепция не оставляет других
толкований.&lt;/p&gt;

&lt;p&gt;На мой взгляд, второй Silent Hill — это “Преступление и наказание” нашего
времени. В нем заложен такой плотный концепт, что можно разбирать очень
долго. Это самообман, оправдание преступления, различные приемы, чтобы убедить
совесть в обратном, подавленная сексуальность, ненависть к зависимому человеку и
целый короб подобных штучек. И это только Джеймс, не считая второстепенных
персонажей вроде Анжелы, Эдди и Лоры. Подобно Раскольникову или Соне, каждого
персонажа можно брать и рассматривать часами.&lt;/p&gt;

&lt;p&gt;Пишу это, чтобы напомнить: второй Silent Hill — важный культурный продукт нашего
времени. Понимаю, это несколько странно: применять к игре формулировки, которые
больше подходят книге. Да, из-за формата не все могут ознакомиться с ней. Но
будь у вас лишние несколько часиков — не знаю, правда, откуда они в сорок лет —
ознакомиться не помешает.&lt;/p&gt;
</description>
        <pubDate>Fri, 18 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/sh2-ost/</link>
        <guid isPermaLink="true">https://grishaev.me/sh2-ost/</guid>
        
        <category>games</category>
        
        <category>silent-hill</category>
        
        <category>ost</category>
        
        
      </item>
    
      <item>
        <title>Микросервисы</title>
        <description>&lt;p&gt;Беда микросервисов в том, что их разработчики не понимают одну вещь. Хотя
формально микросервисы отделены друг от друга, на самом деле они связаны, потому
что подчиняются общим требованиям.&lt;/p&gt;

&lt;p&gt;Обычно об этом не думают и колбасят пачки сервисов. Доходит до того, что один
сервис пишут на Питоне, второй на Ноде, а в третьей команде экстремисты
протащили Хаскель. И все такие — а что такого, у нас микросервисы, общение по
HTTP JSON, какая разница, что крутится в кубернетисе?&lt;/p&gt;

&lt;p&gt;Не все равно хотя бы по следующим причинам.&lt;/p&gt;

&lt;p&gt;По нажатию кнопки микросервис должен сгенерировать HTML-документацию со всеми
апишками и схемами. Все это генерится из кода, а не руками. Документашка пишется
в докстрингах, схемы хранятся в файлах. Далеко не каждый фреймворк обладает
столь мощной интроспекцией, чтобы перебрать свои кишки и понять, на какой
эндпоинт что навешено.&lt;/p&gt;

&lt;p&gt;На практике я наблюдаю, что документацию завозят только если продают апишку
внешним потребителям. Для своих отношение другое — посмотришь исходник, не
рассыпешься.&lt;/p&gt;

&lt;p&gt;Далее трассировка. Каждый сервис трекает в общей базе request-id, с которым его
вызвали. Записывается начало запроса, конец и статус. Должна быть админка, где
вводишь request-id и система рисует граф вызовов с метриками. Опять же, где вы
такое видели?&lt;/p&gt;

&lt;p&gt;Лимиты. У каждого сервиса должен быть механизм рейт-лимита, чтобы его не
ддосили. Как бывает обычно? Ты вызвал сервис 1000 раз, и начинаются крики “кто
нас дидосит!!11”. Так ведь нигде не написано, сколько раз можно вызывать! Должна
быть прокладка, которая считает число запросов в разрезе потребителей и внятно
отвечает, сколько ждать до обнуления. Такое хоть где-то бывает?&lt;/p&gt;

&lt;p&gt;Длины массивов. Сервис принимает список айдишников. Передаю 10 тысяч и получаю
статус 500. Начинается восточный базар: передавай по сто. Нет, это мало, давай
по тысяче? Нет, давай по пятьсот. Ну ок.&lt;/p&gt;

&lt;p&gt;Разумеется, этого не должно быть. У каждого массива или строки должен быть
верхний лимит — чего я не наблюдаю.&lt;/p&gt;

&lt;p&gt;Из этого следует правило: микросервисы должны клепаться не как попало, а из
общей болванки. В ней встроено все, описанное выше: генерилка документации,
трекинг запросов, рейт-лимиты и так далее. В идеале сначала пишут болванку, а
потом множат из нее микросервисы. Но разве так бывает? Все наоборот: сперва
колбасят никак не связанные сервисы, а потом думают, как заставить их идти в
одной упряжке.&lt;/p&gt;

&lt;p&gt;Здесь и кроется предубеждение: хотя формально микросервисы не связаны друг с
другом, на практике это клоны одного проекта. Изменения в клоне отражаются в его
копиях, поэтому ни о какой самобытности не может быть и речи. Правильные
микросервисы — это унификация, полный отказ от самостоятельности.&lt;/p&gt;
</description>
        <pubDate>Fri, 18 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/microservices/</link>
        <guid isPermaLink="true">https://grishaev.me/microservices/</guid>
        
        <category>programming</category>
        
        <category>microservices</category>
        
        <category>architecture</category>
        
        
      </item>
    
      <item>
        <title>Нейролица</title>
        <description>&lt;p&gt;&lt;img src=&quot;/assets/static/aws/fake-faces/1.jpeg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;В интернете все больше лиц, нарисованных нейросетью. На картинке выше — какой-то
медицинский стартап. Предполагается, что все эти улыбчивые люди — довольные
клиенты сервиса.&lt;/p&gt;

&lt;p&gt;Мне неприятно смотреть на эти лица, потому что они выглядят как натертые воском
яблоки. Каждый раз смотрю и не понимаю: откуда эти блики? Они что, собрались на
oiled-вечеринку? Ясно, что иллюстраторы любят градиенты и блики, но почему
нельзя обучить алгоритм на каких-то реальных фото?&lt;/p&gt;

&lt;p&gt;Моральных аспект: искусственные лица подаются как клиенты бизнеса, которых на
самом деле нет. Тут включается внутренний голос и говорит: будь на фотках люди с
фотостоков, тебе было бы легче? Это же модели, актеры, которые сегодня врачи,
завтра домохозяйки, а послезавтра у них съемки белья для Вайлдберриз. Прям так
сильно тебе нужны настоящие люди?&lt;/p&gt;

&lt;p&gt;И отвечаю — да, лично мне нужны. Я не хочу покупать то, что рекламирует
откровенно сгенерированный человек. Хотят моего внимания — пусть напрягутся и
раздобудут настоящего.&lt;/p&gt;
</description>
        <pubDate>Fri, 18 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/fake-faces/</link>
        <guid isPermaLink="true">https://grishaev.me/fake-faces/</guid>
        
        <category>ui</category>
        
        <category>ai</category>
        
        <category>fake</category>
        
        
      </item>
    
      <item>
        <title>Разрешения</title>
        <description>&lt;p&gt;В мобильных операционках мне нравится далеко не все. Но есть одна вещь, которую
я горячо поддерживаю, и которая перешла в десктопы — это система
разрешений. Например, доступ к камере, микрофону, контактам, календарю. Все это
дает контроль за программами, которые лезут, куда не просят.&lt;/p&gt;

&lt;p&gt;Может быть, не все помнят ранний Андроид, а я помню. В версиях до какой-то там у
Андроида не было разрешений по требованию. Это значит, ты ставишь какой-нибудь
Фонарик Про, а он говорит: нужен доступ к фоткам, контактам, акселерометру и еще
десяти пунктам. А если не согласен, иди лесом. У Эпла разрешения были по запросу
с возможностью позже отозвать их. Модель Гугла была ужасна, ее обузили так
сильно, что пришлось сделать как у Эпла.&lt;/p&gt;

&lt;p&gt;Так вот, возвращаясь к десктопу. Хотя в нем есть система разрешений, ее
возможностей не хватает. Например, я бы хотел регулировать, какой программе
можно в интернет, а какой нет. Чтобы снять в настройках чекбокс у программы — и
все, шабаш. Не увидишь модалки, что вышло обновление. Не появится прогресс-бар с
загрузкой. Не будет сбора метрик и кликов. Сейчас, чтобы победить эту хрень,
приходится возиться фаерволом.&lt;/p&gt;

&lt;p&gt;Вряд ли такое произойдет, но помечтать не вредно.&lt;/p&gt;
</description>
        <pubDate>Thu, 10 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/mobile-permissions/</link>
        <guid isPermaLink="true">https://grishaev.me/mobile-permissions/</guid>
        
        <category>ios</category>
        
        <category>permissions</category>
        
        
      </item>
    
      <item>
        <title>Last in Clojure</title>
        <description>&lt;p&gt;&lt;strong&gt;Chat GPT:&lt;/strong&gt; No, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;last&lt;/code&gt; function is not particularly expensive for vectors
in Clojure. It runs in O(1) time because vectors in Clojure support efficient
access to their last element.&lt;/p&gt;

&lt;p&gt;Meanwhile, Clojure:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/static/aws/clojure-last/1.jpeg&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Thu, 10 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/clojure-last/</link>
        <guid isPermaLink="true">https://grishaev.me/clojure-last/</guid>
        
        <category>programming</category>
        
        <category>clojure</category>
        
        <category>chatgpt</category>
        
        
      </item>
    
      <item>
        <title>Подробней о last</title>
        <description>&lt;p&gt;Поскольку &lt;a href=&quot;/clojure-last/&quot;&gt;в заметке про last&lt;/a&gt; отметились только профильные
специалисты (в Телеграме), считаю, нужна его подробная версия. Я и сам понимаю,
что для таких огрызков служит Твиттер, но чего нет — того нет.&lt;/p&gt;

&lt;p&gt;Итак, дело вот в чем. Коллега спрашивает у Chat GPT, насколько дорого получить
последний элемент вектора функцией last в Кложе. На это чат говорит — все
тип-топ, у вектора доступ к последнему элементу работает за O(1).&lt;/p&gt;

&lt;p&gt;Все бы ничего, но в ответе напутаны правда и ложь, и в целом он не верный. Чтобы
в этом убедиться, откроем исходный код функции last:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(dеf
 ^{:doc &quot;Return the last item in coll, in linear time&quot;}
 last (fn ^:static last [s]
        (if (next s)
          (recur (next s))
          (first s))))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Полагаю, даже человек, едва знакомый с Лиспом, увидит паттерн. Функция принимает
коллекцию, и если в ней больше одного элемента (есть хвост), то она вызывает
себя с хвостом. Когда длина хвоста равна одному, возвращается этот элемент.&lt;/p&gt;

&lt;p&gt;В коде нет проверок на тип коллекции, например, отдельно для вектора или
списка. Все очень просто и линейно.&lt;/p&gt;

&lt;p&gt;Наконец, докстринг функции как бы говорит нам: вернуть последний элемент
коллекции за линейное время. Линейное, Карл, то есть такое, что растет с числом
элементов, то есть O(N).&lt;/p&gt;

&lt;p&gt;Поэтому буквальный ответ на вопрос таков: нет, функция last вернет последний
элемент вектора за O(N) шагов. Что не подходит для больших векторов.&lt;/p&gt;

&lt;p&gt;Спрашивается, откуда у чата уверенность в правоте? Дело в том, что вектор
действительно хранит ссылку на последний элемент. Для доступа к нему служит
функция с забавным названием peek (заглянуть). Она работает только для вектора и
для всего остального кинет ошибку.&lt;/p&gt;

&lt;p&gt;Можно предъявить Ричу Хикки: надо было сделать интерфейс &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Lastable&lt;/code&gt; с методом
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getLast&lt;/code&gt;. Обычные коллекции бегут с головы, а вектор берет с конца. Все это
упаковано в &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;last&lt;/code&gt;, который переключает на нужную логику. Все довольны и
смеются. Но имеем то, что имеем, тем более что я согласен с текущим положением
дел. Из всех коллекций только вектор может вернуть последний элемент. Остальным
коллекциям это не положено по идеологическим причинам.&lt;/p&gt;

&lt;p&gt;Скорее всего, чат прочитал вопросы на StackOverflow и слепил некую
компиляцию. Вроде бы да, но вроде бы нет. В этом и состоит вред: чат выдает
что-то, очень похожее на истину. Выглядит настолько правдоподобно, что
принимаешь за чистую монету. Но если проверить, то окажется, что не в карты, а в
нарды, и не корову, а машину, и не выиграл, и проиграл.&lt;/p&gt;

&lt;p&gt;Поэтому я не пользуюсь чатом и аналогами, я в них даже не зарегистрирован. И вам
советую прибегать к ним реже.&lt;/p&gt;
</description>
        <pubDate>Thu, 10 Oct 2024 00:00:00 +0000</pubDate>
        <link>https://grishaev.me/clj-last-explain/</link>
        <guid isPermaLink="true">https://grishaev.me/clj-last-explain/</guid>
        
        <category>programming</category>
        
        
      </item>
    
  </channel>
</rss>
