<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ivan Grishaev's blog</title>
  <meta name="description" content="Writing on programming, education, books and negotiations.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/page38/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod-2/">Книга «Clojure на производстве», второй том</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">

    <ul class="post-list">
        
        <li>

            <h2>
                <a class="post-link" href="/getting-older/">Возрастное</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-10-26T00:00:00+00:00">
        Oct 26, 2020
    </time>

    <a href="/tag/life/" rel="tag">life</a>

</div>


            <div class="entry">
                
                    <p>С интересом наблюдаю, как с возрастом меняются интересы и привычки. Мне почти
тридцать шесть, и вот что начал замечать: все меньше вещей увлекают меня как
прежде. Я не жалуюсь, а скорее изучаю сам себя.</p>

<p>Раньше читал кучу ресурсов по RSS. По крайней мере источников двадцать было
точно. Со временем список сократился до двух, другие надоели. То, что они пишут,
либо неинтересно, либо уже пройдено. Либо у меня свое мнение, и лишний раз
деребить душу не хочется.</p>

<p>Занятно, что чем чаще пишет человек, тем больше этим бесит. О всяких Варламовых,
Лебедевых и Навальных вспоминаю как о страшном сне. Эту дыру не заткнуть, а мне
еще разбираться, какой из двадцати скопившихся постов прочесть. Раз в месяц —
самое то для текущего состояния.</p>

<p>Не прет почти никакое видео из Ютуба. Выщелкиваю подписки, которые когда-то
ревностно искал. Не представляю, как смотреть чье-то выступление на 50
минут. Для меня это стало за гранью.</p>

<p>Сюда же попадают всякие подкасты, лекции, митапы, конфы, доклады, эвенты. Мозг
вообще не воспринимает. Ощущение, что льешь воду в полный чайник. Пытался
слушать подкасты — не помню ничего из прослушанного, только что мысленно
подгонял говорящих: ну скорее, не тяни, короче.</p>

<p>Игры? Когда-то я даже жалел о том, что купил Мак — как теперь играть? Недавно
посмотрел на Ютубе последний Дум. Первая мысль была — почему так однообразно?
Все эти текстуры и дикая графика не прут. Раз в полгода прохожу что-то на
эмуляторе первой Sony PS. При этом пользуюсь перемоткой вперед, чтобы ускорять
медленные сцены.</p>

<p>Не могу смотреть фильмы длинее двух часов — мука. Еле досидел Нолановский
“Довод”. Если хочу что-то посмотреть, прежде всего проверяю
хронометраж. Боготворю старые мульты Диснея по 80 минут с титрами. От
современных 2:15 просто выворачивает.</p>

<p>Уже не влекут другие языки программирования. После Кложи нельзя найти язык,
который зацепит с той же силой. Зачем мне условный Golang? Коллега по работе не
знает, как в нем сделать deep merge. У меня это пять строчек. И пусть оно ест в
три раза больше памяти — мои силы важнее. Кроме Кложи, интересуюсь только Common
Lisp-ом. Уйду в него, если с Кложей что-то пойдет не так.</p>

<p>Раздражает обилие инструментов. Не хочу никаких Кубернетесов — только вчера
Докеру научился. Не хочу всяких солидов, просто дайте словарь и функцию. Хочу
убить тех, кто тянет в проект новые слои абстракций.</p>

<p>Чем заполнить пустоту, чтобы не остаться в пузыре? Пока что справляюсь
книгами. Чередую технические и нон-фикшен, чтобы не было скучно. Сейчас вот
читаю про Джаву и Чернобыль. В книге ты сам себе барин: если затянуто,
пропускаешь. Нравится — вернулся и пережил заново.</p>

<p>Удивительным открытием оказалась своя книга. Писать ее полтора года не так
изнурительно, как вести опенсорс или писать по ночам очередной “свой
проект”. Вот такая асимметрия: каждый день пишешь по две страницы и норм, даже
чувствуешь подъем. А после третьей недели кодинга во внеурочное время кажется,
что разваливаешься на части. Болят шея и руки, глаза как помидоры, на любую
мелочь готов убить.</p>

<p>Опенсорс? Нет, спасибо. Чтобы закрыть ишью в опенсорсе, я взял помощника на
зарплату. Что-то там контрибьютить для меня теперь так тяжело, что просто кричи.</p>

<p>Такие дела. При всем этом мне, тем не менее, интересно следить за сменой
привычек и восприятия. Посмотрим, что будет дальше.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/books-read/">Еще немного книг</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-10-15T00:00:00+00:00">
        Oct 15, 2020
    </time>

    <a href="/tag/book/" rel="tag">book</a>

</div>


            <div class="entry">
                
                    <p>Выкладываю несколько прочитанных книжек. Полную подборку см. <a href="/bookshelf/">на книжной
полке</a>.</p>

<div class="book-list">

    
<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/black-on-red.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Черный о красных. 44 года в Советском Союзе</b>
            <br />
            <em>Роберт Робинсон</em>
        </p>

        <p>
            Автобиография Роберта Робинсона, чернокожего рабочего, который переехал в СССР
            во время Великой депрессии. Робинсон прожил в Союзе почти 45 лет, пережил
            репрессии, войну, доносы и шпионаж. Ближе к старости он все же смог вернуться на
            родину и написал мемуары. Прекрасная книга об СССР: живо, ярко, во всех деталях.
        </p>

    </div>
</div>



<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/freako.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Фрикономика</b>
            <br />
            <em>Стивен Дабнер, Стивен Левитт</em>
        </p>

        <p>
            Серия забавных статей о том, что не все так просто, как кажется на первый
            взгляд. Этакий датамайнинг прошлого века: поиск скрытой информации в массивах
            данных, не очевидные связи между событиями. Книга с юмором, читается легко, удовольствие.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/prav-palach.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Праведный палач. Жизнь, смерть, честь и позор в XVI веке</b>
            <br />
            <em>Джоэл Харрингтон</em>
        </p>

        <p>
            В основе книги лежит дневник палача Франца Шмидта 16 века. Сквозь этот дневник
            автор описывает средневековую жизнь Германии и Европы в целом. Передает уклад
            различный сословий, общественный порядок и место человека в обществе того
            времени. Рекомендую книгу, потому что она рушит многие мифы о Средних веках.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/jedi-tech.png" />
    </div>
    <div class="book-text">
        <p>
            <b>Джедайские техники</b>
            <br />
            <em>Максим Дорофеев</em>
        </p>

        <p>
            Набор советов о том, как справляться с задачами. Своего рода русский аналог Make
            Time (см. ниже). Местами наивно, но взял пару вещей на заметку.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/prog-clojure.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Программирование на Сlojure</b>
            <br />
            <em>Чаз Эмерик, Брайан Карпер, Кристоф Гранд</em>
        </p>

        <p>
            Первая книга о Сlojure на русском языке, которая вышла еще в 2013
            году. Талмуд на 800 страниц. Материал не устарел, советую прочитать
            и сейчас. Минус в том, что мало полезных примеров, нацеленных на
            практику. Рад, что добрался до этой книги уже с багажом знаний о
            языке.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/elem-clojure.png" />
    </div>
    <div class="book-text">
        <p>
            <b>Elements of Сlojure</b>
            <br />
            <em>Zachary Tellman</em>
        </p>

        <p>
            Небольшая книжица о языке. На мой взгляд, слишком абстрактно, трудно
            понять, куда клонит автор. Наиболее полезна вторая часть, где
            обсуждаются правила именования. Полезно, кое-что взял на заметку.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/kafka.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Apache Kafka. Потоковая обработка и анализ данных</b>
            <br />
            <em>Нархид Ния, Шапира Гвен</em>
        </p>

        <p>
            Чтобы каждый раз не материться в работе с Кафкой, купил и прочел
            книжку. Полезно, раскрыто много деталей и тонкостей. К сожалению,
            адский перевод на уровне Гугла пятилетней давности. Держу на полке
            как справочник.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/code.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Код. Тайный язык информатики</b>
            <br />
            <em>Петцольд Чарльз</em>
        </p>

        <p>
            Путешествие в мир компьютеров с самых азов: бинарный код,
            электричество, реле... Только к середине мы доходим до
            сумматора. Лучшая книга чтобы понять, как работает железо на низком
            уровне. Достойный перевод и оформление, особенно схем.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/autor.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Автор, ножницы, бумага</b>
            <br />
            <em>Николай Кононов</em>
        </p>

        <p>
            Набор глав о том, как писать хороший текст. Напоминает
            "Пиши. Сокращай", но в другом ключе, в том числе
            литературном. Коротко, без воды, достойно внимания.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/icoder.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Идеальный программист. Как стать профессионалом разработки ПО</b>
            <br />
            <em>Роберт Мартин</em>
        </p>

        <p>
            Мемуары и советы Роберта Мартина. Книга не столько о
            программировании, сколько о переговорах и отношениях в
            команде. Пригодится, чтобы понять: даже для программиста общение
            важнее кода.
        </p>

    </div>
</div>


<div class="book-item">
    <div class="book-thumb">
        <img src="/assets/static/bookshelf/kreml.jpg" />
    </div>
    <div class="book-text">
        <p>
            <b>Вся кремлевская рать. Краткая история современной России</b>
            <br />
            <em>Михаил Зыгарь</em>
        </p>

        <p>
            Основные события России с 2000 по 2015 год и связанные с ними люди
            из Кремля. Книгу прислали в нагрузку с другой покупкой и я даже
            хотел ее выкинуть. Но читать оказалось так приятно, что проглотил за
            неделю, попутно воскрешая в памяти события прошлого и свою реакцию
            на них. Замечательное произведение.
        </p>

    </div>
</div>


</div>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/mail-bug/">Баг с почтой на Маке</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-10-14T00:00:00+00:00">
        Oct 14, 2020
    </time>

    <a href="/tag/book/" rel="tag">book</a>

</div>


            <div class="entry">
                
                    <p>Наткнулся на странный баг с почтой. Касается MacOS, Mail.app и Gmail, то есть
когда работаешь с Гугловым ящиком из обычного приложения на Маке. Ситуация: если
долго набирать письмо, то при сохранении черновика на сервере создается новое
письмо в цепочке. Выглядит так:</p>

<p><img src="/assets/static/aws/1059232/96000877-0cc70f00-0e40-11eb-9b95-59f8e1aa136f.png" /></p>

<p>Напоминает историю коммитов в Гитхабе. Видно, что каждый раз, когда я делал
паузу, на сервере появлялось новое письмо вместо черновика. В результате
образовалась цепочка на 53(!) письма. Они заполняют выдачу в поиске, мешают
переписке.</p>

<p>Гуглеж показывает, что проблеме уже много лет, и она то появляется, то
исчезает. Переписка в Гугло-группах напоминает синусоиду:</p>

<ul>
  <li>Чел 1: Письма дублируются!</li>
  <li>Гугл: Починили.</li>
  <li>(через год) Чел 2: опять дублируются!</li>
  <li>Гугл: Починили.</li>
  <li>(через полгода) Чел 3: у меня то же самое!</li>
  <li>…</li>
</ul>

<p>На чьей стороне проблема, понять трудно. Скорей всего, при сохранении письма
Mail.app не шлет какой-то айдишник или косячит с параметрами, то есть мячик на
стороне Эпла. Потому что проблемы не было, пока пользовался веб-версией
Gmail. Возможно, сохранение черновика опирается на параметры без документации,
отчего и результат.</p>

<p>Проблему легко победить. Из верхнего меню пройдите по пути Mail →
Preferences → Accounts. В списке учеток выберите нужную и включите таб
“Mailbox Behaviours”:</p>

<p><img src="/assets/static/aws/1059232/96000885-0fc1ff80-0e40-11eb-8df3-a05d9ecf5493.png" /></p>

<p>В поле “Drafts Mailbox” откройте выпадашку, чтобы указать, где хранить
черновики. Укажите последний пункт “Drafts” под секцией “On my Mac”:</p>

<p><img src="/assets/static/aws/1059232/96000886-105a9600-0e40-11eb-9e10-ab6f94bf16e2.png" /></p>

<p>Теперь черновики будут храниться у вас на компе локально. Для коротких писем
черновики вообще не нужны, а длинные лучше набирать в другой программе.</p>

<p>Выставил эту опцию для всех Гугловых ящиков, и проблема ушла.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/book-chitai-gorod/">Книга в Читай-Городе</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-10-14T00:00:00+00:00">
        Oct 14, 2020
    </time>

    <a href="/tag/book/" rel="tag">book</a>

</div>


            <div class="entry">
                
                    
<p>Приятная возможность напомнить о книжке: теперь ее можно купить в сети
<a href="https://www.chitai-gorod.ru/catalog/book/1267534/">“Читай-Город”</a>. На подходе “Буквоед”. Спрашивайте везде!</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/tenet-naming/">Довод. Название</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-09-30T00:00:00+00:00">
        Sep 30, 2020
    </time>

    <a href="/tag/tenet/" rel="tag">tenet</a>, <a href="/tag/movies/" rel="tag">movies</a>

</div>


            <div class="entry">
                
                    <p>Где-то читал, что название Tenet режиссер выбрал потому, что оно читается в обе
стороны. Таким образом он проводит параллель с организацией, которая работает в
обоих временных направлениях. И только недавно, когда шел и думал о чем-то
краешком мозгов, догадался: а ведь русский перевод “довод” тоже читается
наоборот.</p>

<p>До чего же редкий случай! Нашлось слово, которое не только близко по смыслу к
оригиналу (“принцип”, “догмат”), но и повторяет его семантику. Точное
попадание, победа локализаторов.</p>

<p>К сожалению, такое редко случается. Например, скоро выходит мультик Soul (в
российском прокате — Душа). К переводу не подкопаешься, но семантика в том, что
в сюжете переплетается загробная жизнь и музыка в стиле соул. То есть в названии
два смысла — человеческая душа и музыка. Тут ничего не попишешь, бери что-то
одно.</p>

<p>А вот с Доводом зачетно вышло в плане названия. Но про сам фильм — как-нибудь в
другой раз.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-zippers-7/">Зипперы в Clojure (часть 7). Обход в ширину. Улучшенный обмен валют</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-08-30T00:00:00+00:00">
        Aug 30, 2020
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/zippers/" rel="tag">zippers</a>

</div>


            <div class="entry">
                
                    <h2 id="оглавление">Оглавление</h2>

<ul>
  <li><a href="/clj-zippers-1/">Зипперы (часть 1). Азы навигации</a></li>
  <li><a href="/clj-zippers-2/">Зипперы (часть 2). Автонавигация</a></li>
  <li><a href="/clj-zippers-3/">Зипперы (часть 3). XML-зипперы</a></li>
  <li><a href="/clj-zippers-4/">Зипперы (часть 4). Поиск в XML</a></li>
  <li><a href="/clj-zippers-5/">Зипперы (часть 5). Редактирование</a></li>
  <li><a href="/clj-zippers-6/">Зипперы (часть 6). Виртуальные деревья. Обмен валют</a></li>
  <li><a href="/clj-zippers-7/">Зипперы (часть 7). Обход в ширину. Улучшенный обмен валют</a></li>
  <li><a href="/clj-zippers-8/">Зипперы (часть 8). Заключение</a></li>
</ul>

<p>В прошлый раз мы работали с деревом валют, чтобы построить цепочку обмена. Мы
нашли решение задачи, но упомянули, что в особых случаях дерево может получиться
бесконечным. Объясним, как это возможно. Для этого вспомним, как <code class="language-plaintext highlighter-rouge">zip/next</code>
обходит дерево.</p>

<p>Алгоритм называется <a href="https://en.wikipedia.org/wiki/Depth-first_search">depth first search</a> или обход в глубину. При
таком обходе код стремится в первую очередь вниз, а уже потом — в сторону (в
нашем случае вправо). В этом легко убедиться, если разложить данные на части с
помощью зиппера:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">-&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w">
     </span><span class="n">zip/vector-zip</span><span class="w">
     </span><span class="n">iter-zip</span><span class="w">
     </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="n">zip/node</span><span class="p">)</span><span class="w">
     </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nb">println</span><span class="p">))</span><span class="w">

</span><span class="c1">;; 1</span><span class="w">
</span><span class="c1">;; [2 [3] 4]</span><span class="w">
</span><span class="c1">;; 2</span><span class="w">
</span><span class="c1">;; [3]</span><span class="w">
</span><span class="c1">;; 3</span><span class="w">
</span><span class="c1">;; 4</span><span class="w">
</span><span class="c1">;; 5</span><span class="w">
</span></code></pre></div></div>


                    <p><a href="/clj-zippers-7/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-zippers-6/">Зипперы в Clojure (часть 6). Виртуальные деревья. Обмен валют</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-08-12T00:00:00+00:00">
        Aug 12, 2020
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/zippers/" rel="tag">zippers</a>

</div>


            <div class="entry">
                
                    <h2 id="оглавление">Оглавление</h2>

<ul>
  <li><a href="/clj-zippers-1/">Зипперы (часть 1). Азы навигации</a></li>
  <li><a href="/clj-zippers-2/">Зипперы (часть 2). Автонавигация</a></li>
  <li><a href="/clj-zippers-3/">Зипперы (часть 3). XML-зипперы</a></li>
  <li><a href="/clj-zippers-4/">Зипперы (часть 4). Поиск в XML</a></li>
  <li><a href="/clj-zippers-5/">Зипперы (часть 5). Редактирование</a></li>
  <li><a href="/clj-zippers-6/">Зипперы (часть 6). Виртуальные деревья. Обмен валют</a></li>
  <li><a href="/clj-zippers-7/">Зипперы (часть 7). Обход в ширину. Улучшенный обмен валют</a></li>
  <li><a href="/clj-zippers-8/">Зипперы (часть 8). Заключение</a></li>
</ul>

<p>Предыдущих занятий было достаточно, чтобы перейти к экспериментам над
зипперами. Предлагаем читателю подумать над необычным примером.</p>

<p>До сих пор вторая функция, которую мы передавали в зиппер, возвращала потомков
из ветки. Для вектора это была просто <code class="language-plaintext highlighter-rouge">seq</code>, для XML — более сложная комбинация
<code class="language-plaintext highlighter-rouge">(comp seq :content)</code>. Оба варианта отталкиваются от родительского узла, и если
потомков нет, функция вернёт <code class="language-plaintext highlighter-rouge">nil</code>.</p>

<p>Но что если функция вернёт постоянный набор потомков:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">fn</span><span class="w"> </span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nb">seq</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">]))</span><span class="w">
</span></code></pre></div></div>

<p>Как поведёт себя такой зиппер? Напишем его:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">zip-123</span><span class="w">
  </span><span class="p">(</span><span class="nf">zip/zipper</span><span class="w"> </span><span class="n">any?</span><span class="w">
              </span><span class="p">(</span><span class="nb">constantly</span><span class="w"> </span><span class="p">(</span><span class="nb">seq</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">]))</span><span class="w">
              </span><span class="n">nil</span><span class="w">
              </span><span class="mi">1</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>


                    <p><a href="/clj-zippers-6/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-zippers-5/">Зипперы в Clojure (часть 5). Редактирование</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-08-08T00:00:00+00:00">
        Aug 8, 2020
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/zippers/" rel="tag">zippers</a>

</div>


            <div class="entry">
                
                    <h2 id="оглавление">Оглавление</h2>

<ul>
  <li><a href="/clj-zippers-1/">Зипперы (часть 1). Азы навигации</a></li>
  <li><a href="/clj-zippers-2/">Зипперы (часть 2). Автонавигация</a></li>
  <li><a href="/clj-zippers-3/">Зипперы (часть 3). XML-зипперы</a></li>
  <li><a href="/clj-zippers-4/">Зипперы (часть 4). Поиск в XML</a></li>
  <li><a href="/clj-zippers-5/">Зипперы (часть 5). Редактирование</a></li>
  <li><a href="/clj-zippers-6/">Зипперы (часть 6). Виртуальные деревья. Обмен валют</a></li>
  <li><a href="/clj-zippers-7/">Зипперы (часть 7). Обход в ширину. Улучшенный обмен валют</a></li>
  <li><a href="/clj-zippers-8/">Зипперы (часть 8). Заключение</a></li>
</ul>

<p>До сих пор мы игнорировали другую возможность зипперов. Во время обхода можно не
только читать, но и менять локации. В широком плане нам доступны все операции
CRUD (Create, Read, Update, Delete), знакомые из веб-разработки. Ниже мы
разберем, как они работают в зипперах.</p>

<p>Напомним, зиппер принимает третью функцию <code class="language-plaintext highlighter-rouge">make-node</code>, в которую до сих пор мы
передавали <code class="language-plaintext highlighter-rouge">nil</code>. В ней не было нужды, потому что мы только читали
данные. Зиппер вызовет функцию в момент, когда мы просим вернуть данные с учётом
изменений, которые внесли в локации. Функция принимает два параметра: ветку и
потомков. Ее задача — соединить их должным образом.</p>


                    <p><a href="/clj-zippers-5/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/thecode/">Разбор статьи из журнала «Код»</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-08-05T00:00:00+00:00">
        Aug 5, 2020
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>

</div>


            <div class="entry">
                
                    
<p>На Хабре – моя публикация <a href="https://habr.com/ru/post/513910/">Разбор статьи из журнала «Код» (Яндекс
Практикум)</a>.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-zippers-4/">Зипперы в Clojure (часть 4). Поиск в XML</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2020-07-22T00:00:00+00:00">
        Jul 22, 2020
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/zippers/" rel="tag">zippers</a>

</div>


            <div class="entry">
                
                    <h2 id="оглавление">Оглавление</h2>

<ul>
  <li><a href="/clj-zippers-1/">Зипперы (часть 1). Азы навигации</a></li>
  <li><a href="/clj-zippers-2/">Зипперы (часть 2). Автонавигация</a></li>
  <li><a href="/clj-zippers-3/">Зипперы (часть 3). XML-зипперы</a></li>
  <li><a href="/clj-zippers-4/">Зипперы (часть 4). Поиск в XML</a></li>
  <li><a href="/clj-zippers-5/">Зипперы (часть 5). Редактирование</a></li>
  <li><a href="/clj-zippers-6/">Зипперы (часть 6). Виртуальные деревья. Обмен валют</a></li>
  <li><a href="/clj-zippers-7/">Зипперы (часть 7). Обход в ширину. Улучшенный обмен валют</a></li>
  <li><a href="/clj-zippers-8/">Зипперы (часть 8). Заключение</a></li>
</ul>

<p>Предположим, нам поставили задачу: выбрать из XML магазины, где продаются
айфоны. Обратите внимание: мы впервые коснулись связи между узлами, и это
важно. По отдельности выбрать данные легко. Магазины — это локации, у которых
тег <code class="language-plaintext highlighter-rouge">organization</code>. Айфоны — локации, в которых узел с тегом <code class="language-plaintext highlighter-rouge">product</code> и
атрибутом <code class="language-plaintext highlighter-rouge">type="tablet"</code>. Но как найти связь между ними?</p>

<p>В прошлый раз мы разложили XML в последовательность с помощью
<code class="language-plaintext highlighter-rouge">xml-seq</code>. Проблема в том, что функция порождает коллекцию узлов без какой-либо
связи, что не даёт нам решить задачу. Покажем это на примере. Для начала получим
цепочку узлов:</p>


                    <p><a href="/clj-zippers-4/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
    </ul>

    <h4>
        
        <a href="/page37" class="previous">&larr;</a>
        
        <span class="page_number ">Страница 38 из 86</span>
        
        <a href="/page39" class="next">&rarr;</a>
        
    </h4>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="https://t.me/igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
