<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>User-Agent parser for Clojure</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/en/user-agent/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">

    <h1 class="post-title" itemprop="name headline">User-Agent parser for Clojure</h1>

    
<div class="post-meta">

    <time class="post-time"
          datetime="2018-09-29T00:00:00+00:00">
        Sep 29, 2018
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/programming/" rel="tag">programming</a>

</div>


  </header>

  <div class="post-content" itemprop="articleBody">
    
<p>Today, I detached another chunk of my codebase into a <a href="https://github.com/igrishaev/user-agent">separate library</a>. This time, it is for parsing User-Agent headers with Clojure. For a long time, I’ve been copying it from project to project, but now I decided to keep it aside from the code because it is not connected to the business logic. All the technical stuff that is not related to the very problem we are trying to solve should be kept as a separate library, I believe. The main code is all about the business problem.</p>

<p>The library ships only one function, which is <code class="language-plaintext highlighter-rouge">parse</code>. It takes a string and returns a detailed map with information about the browser’s type, its version, manufacturer, operating system, etc. The library relies on good old Java <a href="http://uadetector.sourceforge.net/">UA Detector</a> with the latest set of patterns. I know, there are already some solutions for that. But they either do not provide full information about a user or maintainers do not accept pull requests.</p>

<p>Add it to your project:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">:dependencies</span><span class="w"> </span><span class="p">[[</span><span class="n">user-agent</span><span class="w"> </span><span class="s">"0.1.0-SNAPSHOT"</span><span class="p">]]</span><span class="w">
</span></code></pre></div></div>

<p>Usage:</p>

<div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">ns</span><span class="w"> </span><span class="n">some.ns</span><span class="w">
  </span><span class="p">(</span><span class="no">:require</span><span class="w"> </span><span class="p">[</span><span class="n">user-agent</span><span class="w"> </span><span class="no">:as</span><span class="w"> </span><span class="n">ua</span><span class="p">]))</span><span class="w">

</span><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">ua-sample</span><span class="w">
  </span><span class="s">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36"</span><span class="p">)</span><span class="w">

</span><span class="p">(</span><span class="nf">ua/parse</span><span class="w"> </span><span class="n">ua-sample</span><span class="p">)</span><span class="w">

</span><span class="p">{</span><span class="no">:producer</span><span class="w"> </span><span class="s">"Google Inc."</span><span class="w">
 </span><span class="no">:family</span><span class="w"> </span><span class="no">:CHROME</span><span class="w">
 </span><span class="no">:name</span><span class="w"> </span><span class="s">"Chrome"</span><span class="w">
 </span><span class="no">:type</span><span class="w"> </span><span class="no">:BROWSER</span><span class="w">
 </span><span class="no">:icon</span><span class="w"> </span><span class="s">"chrome.png"</span><span class="w">
 </span><span class="no">:producer-url</span><span class="w"> </span><span class="s">"http://www.google.com/"</span><span class="w">
 </span><span class="no">:url</span><span class="w"> </span><span class="s">"http://www.google.com/chrome"</span><span class="w">
 </span><span class="no">:device</span><span class="w"> </span><span class="p">{</span><span class="no">:category</span><span class="w"> </span><span class="no">:PERSONAL_COMPUTER</span><span class="w">
          </span><span class="no">:name</span><span class="w"> </span><span class="s">"Personal computer"</span><span class="p">}</span><span class="w">
 </span><span class="no">:os</span><span class="w">
 </span><span class="p">{</span><span class="no">:family</span><span class="w"> </span><span class="no">:OS_X</span><span class="w">
  </span><span class="no">:family-name</span><span class="w"> </span><span class="s">"OS X"</span><span class="w">
  </span><span class="no">:name</span><span class="w"> </span><span class="s">"OS X"</span><span class="w">
  </span><span class="no">:producer</span><span class="w"> </span><span class="s">"Apple Computer, Inc."</span><span class="w">
  </span><span class="no">:producer-url</span><span class="w"> </span><span class="s">"http://www.apple.com/"</span><span class="w">
  </span><span class="no">:url</span><span class="w"> </span><span class="s">"http://en.wikipedia.org/wiki/Mac_OS_X"</span><span class="w">
  </span><span class="no">:version</span><span class="w">
  </span><span class="p">{</span><span class="no">:bug-fix</span><span class="w"> </span><span class="s">"6"</span><span class="w">
   </span><span class="no">:extension</span><span class="w"> </span><span class="s">""</span><span class="w">
   </span><span class="no">:groups</span><span class="w"> </span><span class="p">[</span><span class="s">"10"</span><span class="w"> </span><span class="s">"11"</span><span class="w"> </span><span class="s">"6"</span><span class="p">]</span><span class="w">
   </span><span class="no">:major</span><span class="w"> </span><span class="s">"10"</span><span class="w">
   </span><span class="no">:minor</span><span class="w"> </span><span class="s">"11"</span><span class="w">
   </span><span class="no">:version</span><span class="w"> </span><span class="s">"10.11.6"</span><span class="p">}}</span><span class="w">
 </span><span class="no">:type-name</span><span class="w"> </span><span class="s">"Browser"</span><span class="w">
 </span><span class="no">:version</span><span class="w">
 </span><span class="p">{</span><span class="no">:bug-fix</span><span class="w"> </span><span class="s">"3396"</span><span class="w">
  </span><span class="no">:extension</span><span class="w"> </span><span class="s">""</span><span class="w">
  </span><span class="no">:groups</span><span class="w"> </span><span class="p">[</span><span class="s">"67"</span><span class="w"> </span><span class="s">"0"</span><span class="w"> </span><span class="s">"3396"</span><span class="w"> </span><span class="s">"99"</span><span class="p">]</span><span class="w">
  </span><span class="no">:major</span><span class="w"> </span><span class="s">"67"</span><span class="w">
  </span><span class="no">:minor</span><span class="w"> </span><span class="s">"0"</span><span class="w">
  </span><span class="no">:version</span><span class="w"> </span><span class="s">"67.0.3396.99"</span><span class="p">}}</span><span class="w">
</span></code></pre></div></div>

<p>It supports plenty of desktop and mobile browsers as well as unusual ones like bots, crawlers or TVs. Hope you’ll enjoy it, your suggestions and PR’s are welcome.</p>

  </div>

</article>

<center>
    <p>
        <small>Нашли ошибку? Выделите мышкой и нажмите Ctrl/&#8984;+Enter</small>
    </p>
</center>






<center>Комментариев пока нет</center>









<form id="comment-form" method="POST" action="https://functions.yandexcloud.net/d4ehfuf08fjfjr59ivnf">

    <div class="block">
        <p class="comment-form-label"><small>Your name</small></p>
        <input required id="comment-form-author" name="author" type="text">
    </div>

    <div class="block">
        <p class="comment-form-label"><small>Comment (markdown syntax)</small></p>
        <textarea required id="comment-form-comment" name="comment"></textarea>
    </div>

    <input required name="path" type="hidden" value="/en/user-agent/">
    <input required name="captcha" type="hidden" value="2 &#215; 4">

    <div class="block">
        <span class="comment-form-label"><small>2 &#215; 4 = </small></span>
        <input required id="comment-form-solution" name="solution" type="text">
    </div>

    <div class="block">
        <button id="comment-form-send" type="submit">Send</button>
    </div>

</form>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="tg://resolve?domain=igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
