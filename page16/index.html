<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ivan Grishaev's blog</title>
  <meta name="description" content="Writing on programming, education, books and negotiations.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/page16/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img src="/assets/static/photo-round-small.png" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">

    <ul class="post-list">
        
        <li>

            <h2>
                <a class="post-link" href="/clj-book-systems/">Системы в Clojure</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-08-25T00:00:00+00:00">
        Aug 25, 2019
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/book/" rel="tag">book</a>, <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/systems/" rel="tag">systems</a>

</div>


            <div class="entry">
                
                    <p><em>В этой главе мы поговорим о системах. Рассмотрим, как составить проект из
отдельных частей и заставить их работать вместе.</em></p>

<h2>

    Содержание

</h2>

<ul id="toc-item-clj-book-systems">
  <li><a href="#подробнее-о-системе" id="toc-item-clj-book-systems-подробнее-о-системе">Подробнее о системе</a></li>
  <li><a href="#зависимости" id="toc-item-clj-book-systems-зависимости">Зависимости</a></li>
  <li><a href="#преимущества" id="toc-item-clj-book-systems-преимущества">Преимущества</a></li>
  <li><a href="#подготовка-к-обзору" id="toc-item-clj-book-systems-подготовка-к-обзору">Подготовка к обзору</a></li>
  <li><a href="#база-данных" id="toc-item-clj-book-systems-база-данных">База данных</a></li>
  <li><a href="#docker" id="toc-item-clj-book-systems-docker">Docker</a></li>
  <li><a href="#mount" id="toc-item-clj-book-systems-mount">Mount</a>    <ul>
      <li><a href="#первая-сущность" id="toc-item-clj-book-systems-первая-сущность">Первая сущность</a></li>
      <li><a href="#связь-с-конфигурацией" id="toc-item-clj-book-systems-связь-с-конфигурацией">Связь с конфигурацией</a></li>
      <li><a href="#база-данных-1" id="toc-item-clj-book-systems-база-данных-1">База данных</a></li>
      <li><a href="#фоновая-задача" id="toc-item-clj-book-systems-фоновая-задача">Фоновая задача</a></li>
      <li><a href="#все-вместе" id="toc-item-clj-book-systems-все-вместе">Все вместе</a></li>
      <li><a href="#зависимости-1" id="toc-item-clj-book-systems-зависимости-1">Зависимости</a></li>
      <li><a href="#внутреннее-устройство" id="toc-item-clj-book-systems-внутреннее-устройство">Внутреннее устройство</a></li>
      <li><a href="#состояние" id="toc-item-clj-book-systems-состояние">Состояние</a></li>
      <li><a href="#выборочный-запуск" id="toc-item-clj-book-systems-выборочный-запуск">Выборочный запуск</a></li>
      <li><a href="#проблема-перезагрузки" id="toc-item-clj-book-systems-проблема-перезагрузки">Проблема перезагрузки</a></li>
      <li><a href="#самостоятельная-работа" id="toc-item-clj-book-systems-самостоятельная-работа">Самостоятельная работа</a></li>
    </ul>
  </li>
  <li><a href="#component" id="toc-item-clj-book-systems-component">Component</a>    <ul>
      <li><a href="#устройство" id="toc-item-clj-book-systems-устройство">Устройство</a></li>
      <li><a href="#первый-компонент" id="toc-item-clj-book-systems-первый-компонент">Первый компонент</a></li>
      <li><a href="#конструктор" id="toc-item-clj-book-systems-конструктор">Конструктор</a></li>
      <li><a href="#особенность-слотов" id="toc-item-clj-book-systems-особенность-слотов">Особенность слотов</a></li>
      <li><a href="#компонент-базы" id="toc-item-clj-book-systems-компонент-базы">Компонент базы</a></li>
      <li><a href="#транзакционный-компонент" id="toc-item-clj-book-systems-транзакционный-компонент">Транзакционный компонент</a></li>
      <li><a href="#воркер" id="toc-item-clj-book-systems-воркер">Воркер</a></li>
      <li><a href="#ручные-зависимости" id="toc-item-clj-book-systems-ручные-зависимости">Ручные зависимости</a></li>
      <li><a href="#промышленная-система" id="toc-item-clj-book-systems-промышленная-система">Промышленная система</a></li>
      <li><a href="#хранение-системы" id="toc-item-clj-book-systems-хранение-системы">Хранение системы</a></li>
      <li><a href="#корректное-завершение" id="toc-item-clj-book-systems-корректное-завершение">Корректное завершение</a></li>
      <li><a href="#ожидание-системы" id="toc-item-clj-book-systems-ожидание-системы">Ожидание системы</a></li>
      <li><a href="#улучшаем-зависимости" id="toc-item-clj-book-systems-улучшаем-зависимости">Улучшаем зависимости</a></li>
      <li><a href="#группировка-слотов" id="toc-item-clj-book-systems-группировка-слотов">Группировка слотов</a></li>
      <li><a href="#условная-система" id="toc-item-clj-book-systems-условная-система">Условная система</a></li>
      <li><a href="#спуск-системы" id="toc-item-clj-book-systems-спуск-системы">Спуск системы</a></li>
      <li><a href="#идемпотентность" id="toc-item-clj-book-systems-идемпотентность">Идемпотентность</a></li>
    </ul>
  </li>
  <li><a href="#integrant" id="toc-item-clj-book-systems-integrant">Integrant</a>    <ul>
      <li><a href="#базовое-устройство" id="toc-item-clj-book-systems-базовое-устройство">Базовое устройство</a></li>
      <li><a href="#первые-компоненты" id="toc-item-clj-book-systems-первые-компоненты">Первые компоненты</a></li>
      <li><a href="#зависимости-2" id="toc-item-clj-book-systems-зависимости-2">Зависимости</a></li>
      <li><a href="#параллели-с-component" id="toc-item-clj-book-systems-параллели-с-component">Параллели с Component</a></li>
      <li><a href="#проблема-потери-ключей" id="toc-item-clj-book-systems-проблема-потери-ключей">Проблема потери ключей</a></li>
      <li><a href="#система-в-файле" id="toc-item-clj-book-systems-система-в-файле">Система в файле</a></li>
      <li><a href="#наследование-ключей" id="toc-item-clj-book-systems-наследование-ключей">Наследование ключей</a></li>
      <li><a href="#другие-стадии-компонента" id="toc-item-clj-book-systems-другие-стадии-компонента">Другие стадии компонента</a></li>
      <li><a href="#подготовка" id="toc-item-clj-book-systems-подготовка">Подготовка</a></li>
      <li><a href="#спека" id="toc-item-clj-book-systems-спека">Спека</a></li>
      <li><a href="#приостановка" id="toc-item-clj-book-systems-приостановка">Приостановка</a></li>
    </ul>
  </li>
  <li><a href="#заключение" id="toc-item-clj-book-systems-заключение">Заключение</a></li>
</ul>

<p>Понятие системы тесно связано с конфигурацией, которую мы подробно рассмотрели
недавно. На этапе черновика конфигурация и системы составляли одну главу, но со
временем стало ясно, что это отдельные темы. Причина кроется не столько в объеме
материала, сколько в семантике. Конфигурация и система это не одно и то же.</p>

<p class="draft-warn">Внимание! Вы читаете черновик к книге <a href="/clojure-in-prod/">“Clojure на производстве”</a>. Для
книги я переписывал его много раз, но в блоге осталась старая версия. Здесь она
для истории, а вам я рекомендую купить книжку.</p>

<p>Конфигурация учит тому, как получить параметры из внешнего мира. Как выстроить
этот процесс согласно производству и пожеланиям команды. Система означает
внутреннее устройство программы. Это набор компонентов с логическими связями и
иерархией.</p>

<p>Система зависит от конфигурации, но не строго один к одному. Для одной и той же
конфигурации бывают разные системы и наоборот. Главное отличие в следующем:
конфигурация отвечает на вопрос как получить параметры, а система знает, как ими
распорядиться.</p>


                    <p><a href="/clj-book-systems/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/movies/">Слабые фильмы</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-08-12T00:00:00+00:00">
        Aug 12, 2019
    </time>

    <a href="/tag/movies/" rel="tag">movies</a>, <a href="/tag/life/" rel="tag">life</a>

</div>


            <div class="entry">
                
                    <p>Уже пятый раз со мной такое. Читаю на условной Медузе про нашумевший фильм, иду,
и… фильм оказывается удивительно слабым. Кинокритик разливался соловьем, а
фильм затянут, конфликт примитивен, диалоги и сцены натянуты. Выхожу из зала с
разочарованием.</p>

<p>Это случается все чаще и чаще. То ли я постарел, то ли ожидаю слишком многого. Я
далеко не киноман — появляюсь в кинотеатре раз в три месяца. Мои чувства не
притуплены бесконечными сериалами и фильмами. Может, в этом и проблема, как ни
парадоксально?</p>

<p>Я вспомнил фильмы, от которых многого ожидал, но в итоге они оказались слабыми.</p>

<p><strong>Магазинные воришки</strong></p>

<p>Фильм про семью бедняков в Японии. Живут в нищите, зато дружно. Родители учат
детей воровать в магазинах. Поначалу приятно: японский быт, ужин дошираками в
тесном кругу. Семья подбирает девочку, с которой плохо обращаются, и ее
принимают как дочь. Но потом слишком затянуто, ноль действия.</p>


                    <p><a href="/movies/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/bad-projects/">Плохие проекты</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-08-02T00:00:00+00:00">
        Aug 2, 2019
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/projects/" rel="tag">projects</a>

</div>


            <div class="entry">
                
                    <p><em>Поговорим о плохих проектах. Как понять, что проект плохой, а команда не
профессиональна? Я собрал несколько признаков, которые прямо или косвенно
говорят об этом. С каждым из них я борюсь много лет и вот решил написать. Если
вы узнали свою команду, на вашем месте я бы встревожился.</em></p>

<p><strong>Проект не подготовлен к старту</strong></p>

<p>К сожалению, не каждый проект готов к старту после того, как вы скачали его
код. И редко когда в проекте есть скрипт или Make-файл, который подготовит все
нужное. Хотя технически это возможно.</p>

<p>Например, в условный Makefile можно засунуть установку виртуального окружения,
утилит и пакетов, перенос файлов, скачивание ресурсов с сервера… но почти
никто этого не делает. Приходится долбить коллег тупыми вопросами. Где взять
этот файлик? Почему не ставится эта библиотека?</p>

<p>Причина кроется в лени и неуважении к коллегам. Если ты проделал рутинную
подготовку, то почему бы не скопировать команды терминала в файл? Разве не
очевидно, что следующий разработчик пойдет по тем же граблям?</p>

<p>В каждом проекте я держу Makefile и наполняю его разными задачами. Это база
знаний о том, что можно сделать с проектом. Иногда коллега что-то спрашивает, а
я отвечаю с именем Make-задачи, которую нужно запустить.</p>

<p>Если проект стартует только после часовой ручной подготовки, это плохой
проект. Плох не код, а команда, которая его поддерживает. У них не принято
думать об удобстве коллег, что критично в повседневной работе.</p>


                    <p><a href="/bad-projects/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/slides/">Слайды</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-07-22T00:00:00+00:00">
        Jul 22, 2019
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/slides/" rel="tag">slides</a>

</div>


            <div class="entry">
                
                    
<p>Я смонтировал около ста выступлений (<a href="https://www.youtube.com/channel/UCkmu866apk8FbOMuEIQvH0g/videos">раз</a>, <a href="https://grishaev.me/video/">два</a>,
<a href="https://www.youtube.com/channel/UCeg__Hf-lzDamDu_CY9ibHQ/videos">три</a>) и подметил недостаток, про который мало кто говорит.</p>

<p>Вот закончил человек презентацию. Спасибо, вопросы? Кто-то задал, уточняет
детали. Выступающий: это же было на третьем слайде! И давай мотать в самое
начало с тридцать пятого слайда на третий.</p>

<p>Так делать не надо. Во-первых, если вопрос по существу и зритель следил за
мыслью, показывать слайд опять нет смысла. Вы уже показывали его, но что-то
осталось непонятно. Скорей всего это вы объяснили плохо. Не нужно держать
зрителя за дурака и тыкать ему тот же слайд. Правильно объяснить другими
примерами и образами.</p>

<p>Во-вторых, во время перемотки образуется дурацкая пауза. Нажать двадцать раз на
кнопку не так просто, и секунд пять-десять зрители ждут. Это мертвая зона, от
которой становится неловко. Всех, кто выходит на сцену, учат — пауз быть не
должно, особенно технических. Вы со своей презентацией не исключение.</p>

<p>Возьмите на заметку: не мотать слайды из конца в конец.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/wired/">Прослушка</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-07-16T00:00:00+00:00">
        Jul 16, 2019
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/wired/" rel="tag">wired</a>, <a href="/tag/google/" rel="tag">google</a>

</div>


            <div class="entry">
                
                    <p>У нас дома телевизор, но мы пользуемся им как панелью. Антенны нет, подключаю
ноут по HDMI и телек виден как второй монитор. Недавно обнаружил, что девайс
продвинутый, с магазином приложений. Поставил Ютуб, зашел под учеткой и теперь
смотрю без ноута.</p>

<p>Вчера включал дочке мульты. На главной Ютуба рекомендованные видео. Обычно это
советские мультики вперемешку с тем, что я слушаю на работе. То есть
Цветик-Семицветик — Korn — Кошкин дом — Enigma и так далее.</p>

<p>Но то, что я вчера увидел, заставило насторожиться. Ютуб предлагал к просмотру
“Самогонщики” Гайдая. Помните, комедийная новелла с забавной троицей? С обложки
смотрят Моргунов, Никулин и Вицин с характерными физиономиями.</p>

<p>Я стал ломать голову, с какого перепугу Гугл рекомендует что-то подобное, и не
находил ответа. Я не смотрел ничего из советского кинематографа лет пять. Не
гуглил биографии актеров. Мои интересы полностью ортогональны “Самогонщикам” и
всему творческому пласту того времени.</p>

<p>А потом догадался, и стало не по себе.</p>

<p>Днем раньше я ехал в поезде. Ездили с сыном в деревню к бабушке. Поезд был
фирменный, сидели в купе. Над входом в купе висел телевизор, по которому крутили
“приключения Шурика”. В поездке я открывал ноут и подключал хот-спот. Интересное
совпадение — вчера ты сидел возле телевизора с “Шуриком”, а сегодня Ютуб
предлагает “Самогонщиков”.</p>

<p>Если это так, остается одно объяснение. Устройства слушают шум вокруг нас и
отправляют в сервисы Гугла. Система распознает музыку, и корректирует веса
рекомендаций.</p>

<p>Конечно, это не новость. Все большие компании хоть раз да были замечены в сборе
данных без нашего ведома. На месте фирмы я бы тоже их собирал. Это ценная
информация, с какой стати отказываться?</p>

<p>Но это первый раз, когда я столкнулся с такой сложной схемой. Передать шум
поезда на сервер, распознать “Операцию Ы” и перестроить рекомендации – это
все-таки сильно. У меня нет претензий к Гуглу: никто не умер, я сам на все
подписался. Только удивление и тема для размышлений.</p>

<p>Кстати, именно поэтому я вырезал в веб-версии Ютуба блоки с рекомендациями. Это
делается ад-блоком: навел курсор на регион и добавляешь селектор в черный
список. Я не могу жить с этими блоками. Они начисто лишают хоть какой-то
приватности, выдают все до последней интимности.</p>

<p>Однажды я посмотрел выступление Петросяна, которое запомнил из детства. Блок
наводнился Степаненко, Маменко, бабками из Кривого зеркала и всей этой
публикой. Не отмоешься!</p>

<p>Я полагаю, что системы рекомендации чувствительны к резкой смене
контента. Возможно, это сделано специально. Может быть, для системы это значит,
что за комп сел другой человек. Никто же не переключает учетку на айпаде,
которым пользуется вся семья. Если смотрели пять Лунтиков, а потом Петросяна,
это значит, что девайс передали другому человеку. И теперь надо рекомендовать не
Смешариков, а Степаненко.</p>

<p>А если я не прав, то расскажите кто знает эту кухню.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-book-config/">Конфигурация</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-07-14T00:00:00+00:00">
        Jul 14, 2019
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/book/" rel="tag">book</a>, <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/config/" rel="tag">config</a>

</div>


            <div class="entry">
                
                    
<h2>

    Содержание

</h2>

<ul id="toc-item-clj-book-config">
  <li><a href="#постановка-проблемы" id="toc-item-clj-book-config-постановка-проблемы">Постановка проблемы</a></li>
  <li><a href="#семантика" id="toc-item-clj-book-config-семантика">Семантика</a></li>
  <li><a href="#цикл-конфигурации" id="toc-item-clj-book-config-цикл-конфигурации">Цикл конфигурации</a></li>
  <li><a href="#ошибки-конфигурации" id="toc-item-clj-book-config-ошибки-конфигурации">Ошибки конфигурации</a></li>
  <li><a href="#практика" id="toc-item-clj-book-config-практика">Практика</a>    <ul>
      <li><a href="#анализ-результата" id="toc-item-clj-book-config-анализ-результата">Анализ результата</a></li>
    </ul>
  </li>
  <li><a href="#подробнее-о-переменных-среды" id="toc-item-clj-book-config-подробнее-о-переменных-среды">Подробнее о переменных среды</a>    <ul>
      <li><a href="#локальные-и-глобальные-переменные" id="toc-item-clj-book-config-локальные-и-глобальные-переменные">Локальные и глобальные переменные</a></li>
      <li><a href="#переменные-как-конфигурация" id="toc-item-clj-book-config-переменные-как-конфигурация">Переменные как конфигурация</a></li>
      <li><a href="#env-файлы" id="toc-item-clj-book-config-env-файлы">Env-файлы</a></li>
    </ul>
  </li>
  <li><a href="#переменные-среды-в-clojure" id="toc-item-clj-book-config-переменные-среды-в-clojure">Переменные среды в Clojure</a>    <ul>
      <li><a href="#проблема-лишних-ключей" id="toc-item-clj-book-config-проблема-лишних-ключей">Проблема лишних ключей</a></li>
      <li><a href="#загрузчик-среды" id="toc-item-clj-book-config-загрузчик-среды">Загрузчик среды</a></li>
      <li><a href="#вывод-структуры" id="toc-item-clj-book-config-вывод-структуры">Вывод структуры</a></li>
    </ul>
  </li>
  <li><a href="#простой-менеджер-конфигурации" id="toc-item-clj-book-config-простой-менеджер-конфигурации">Простой менеджер конфигурации</a></li>
  <li><a href="#чтение-среды-из-конфигурации" id="toc-item-clj-book-config-чтение-среды-из-конфигурации">Чтение среды из конфигурации</a></li>
  <li><a href="#короткий-обзор-форматов" id="toc-item-clj-book-config-короткий-обзор-форматов">Короткий обзор форматов</a>    <ul>
      <li><a href="#json" id="toc-item-clj-book-config-json">JSON</a></li>
      <li><a href="#yaml" id="toc-item-clj-book-config-yaml">YAML</a></li>
      <li><a href="#edn" id="toc-item-clj-book-config-edn">EDN</a></li>
    </ul>
  </li>
  <li><a href="#промышленные-решения" id="toc-item-clj-book-config-промышленные-решения">Промышленные решения</a>    <ul>
      <li><a href="#cprop" id="toc-item-clj-book-config-cprop">Cprop</a></li>
      <li><a href="#aero" id="toc-item-clj-book-config-aero">Aero</a></li>
      <li><a href="#yummy" id="toc-item-clj-book-config-yummy">Yummy</a></li>
    </ul>
  </li>
  <li><a href="#заключение" id="toc-item-clj-book-config-заключение">Заключение</a></li>
</ul>

<p>В этой главе мы рассмотрим, как сделать Clojure-проект удобным в плане
настроек. Мы разберем основные приемы конфигурирования: форматы файлов,
переменные среды, несколько библиотек, достоинства и недостатки различных
подходов.</p>

<p class="draft-warn">Внимание! Вы читаете черновик к книге <a href="/clojure-in-prod/">“Clojure на производстве”</a>. Для
книги я переписывал его много раз, но в блоге осталась старая версия. Здесь она
для истории, а вам я рекомендую купить книжку.</p>


                    <p><a href="/clj-book-config/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/feedback/">Не хочу мнений</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-06-27T00:00:00+00:00">
        Jun 27, 2019
    </time>

    <a href="/tag/life/" rel="tag">life</a>

</div>


            <div class="entry">
                
                    <p>Я мечтаю о том, чтобы иногда что-то высказать, но не получить обратной связи. Не
услышать, что думает собеседник. Не обязательно каждый раз, хотя бы изредка,
потому что это роскошь.</p>

<p>Ведь как бывает: скажешь что-нибудь про новую книгу, фильм или программу, и что?
Тебе обязательно ответят. Скажут, что книга устарела, в другой написано
лучше. Что программа не нужна, когда все уже есть из коробки. Что в фильме
плохие актеры и вообще послушай, сейчас я тебе все расскажу.</p>

<p>Так, стоп. Я не просил чужих мнений. Почему-то у людей не укладывается в голове
простая вещь. Их мнение никто не спрашивал! Если я сказал про новую книгу, я не
прошу чужих оценок. Я просто сказал. Не нравится книга — проигнорируй. Или
попроси не разговаривать о книгах, я не обижусь, правда.</p>

<p>Когда мне говорят про новый софт или фильм, я лишь пожимаю плечами или
благодарю. Новый редактор? Ну ок, здорово. Понятно, что я его никогда не
поставлю, но собеседнику-то какая разница? Он тащится, ему клево. Порадуйся за
него, с тебя не убудет.</p>

<p>Не надо сразу пропихивать свое мнение. Оно важно только по требованию. Вот если
бы я подошел и спросил, какую книгу почитать в следующей поездке, тогда другое
дело. Но я же не подошел.</p>

<p>Несколько лет назад я страдал такой же фигней, пока не нашлось средство. Я тогда
увлекся Хаскелом и монадами и приседал на уши там, где меня не
просили. Прекрасно понимаю, что я нес ахинею, но люди вокруг были не лучше. Они
банально не слушали, что я говорю и несли встречную пургу. Получался как бы спор
глухого с немым.</p>

<p>Однажды моим собеседником был очень опытный программист, человек гораздо
старше. Он триггернул меня, и я завел ту же песню. Собеседник, внезапно, молчал
и слушал с таким вниманием, как никто и никогда не слушал. Я сначала
занервничал: почему он не перебивает, не приводит аргументы? Зря что ли я
заготовил доводы против?</p>

<p>И в этот момент я услышал сам себя. Понятно, я и раньше слышал, но в этот раз
это случилось как будто со стороны. Я осознал, что выгляжу жалко, что не понимаю
сути, что повторяю чужие слова. Еще я понял, что собеседник это понял. Поэтому
поскорей закончил разговор и больше так не делал.</p>

<p>Понятно, что этого бы не случилось, не будь того собеседника рядом. А ведь он
ничего особенного не сделал — просто слушал и смотрел в глаза! Он был даже не
собеседник, а слушатель. Благодаря ему я один раз себя услышал, и такая была
польза.</p>

<p>С тех пор я хочу, чтобы в моем окружении было больше людей, которые умеют
слушать. Не потому, что с моих уст сыплются перлы мудрости. А потому, что я хочу
иногда слышать сам себя, а не чужое мнение.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-book-mutability/">Изменяемость в Clojure</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-06-16T00:00:00+00:00">
        Jun 16, 2019
    </time>

    <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/book/" rel="tag">book</a>, <a href="/tag/programming/" rel="tag">programming</a>

</div>


            <div class="entry">
                
                    
<h2>

    Содержание

</h2>

<ul id="toc-item-clj-book-mutability">
  <li><a href="#общие-проблемы-изменяемых-данных" id="toc-item-clj-book-mutability-общие-проблемы-изменяемых-данных">Общие проблемы изменяемых данных</a>    <ul>
      <li><a href="#в-защиту-состояния" id="toc-item-clj-book-mutability-в-защиту-состояния">В защиту состояния</a></li>
    </ul>
  </li>
  <li><a href="#атомы" id="toc-item-clj-book-mutability-атомы">Атомы</a>    <ul>
      <li><a href="#приращение-атома" id="toc-item-clj-book-mutability-приращение-атома">Приращение атома</a></li>
      <li><a href="#совместный-доступ" id="toc-item-clj-book-mutability-совместный-доступ">Совместный доступ</a></li>
      <li><a href="#валидаторы-и-вотчеры" id="toc-item-clj-book-mutability-валидаторы-и-вотчеры">Валидаторы и вотчеры</a></li>
      <li><a href="#другие-примеры" id="toc-item-clj-book-mutability-другие-примеры">Другие примеры</a></li>
    </ul>
  </li>
  <li><a href="#volatile" id="toc-item-clj-book-mutability-volatile">Volatile</a>    <ul>
      <li><a href="#применение" id="toc-item-clj-book-mutability-применение">Применение</a></li>
    </ul>
  </li>
  <li><a href="#переходные-коллекции" id="toc-item-clj-book-mutability-переходные-коллекции">Переходные коллекции</a>    <ul>
      <li><a href="#технические-детали" id="toc-item-clj-book-mutability-технические-детали">Технические детали</a></li>
      <li><a href="#итерация-с-изменением" id="toc-item-clj-book-mutability-итерация-с-изменением">Итерация с изменением</a></li>
      <li><a href="#семантика-и-ограничения" id="toc-item-clj-book-mutability-семантика-и-ограничения">Семантика и ограничения</a></li>
    </ul>
  </li>
  <li><a href="#подмена-переменных-alter-var-root" id="toc-item-clj-book-mutability-подмена-переменных-alter-var-root">Подмена переменных. Alter-var-root</a>    <ul>
      <li><a href="#понятие-переменной" id="toc-item-clj-book-mutability-понятие-переменной">Понятие переменной</a></li>
      <li><a href="#запуск-по-требованию" id="toc-item-clj-book-mutability-запуск-по-требованию">Запуск по требованию</a></li>
      <li><a href="#коротко-о-системах" id="toc-item-clj-book-mutability-коротко-о-системах">Коротко о системах</a></li>
      <li><a href="#патчинг" id="toc-item-clj-book-mutability-патчинг">Патчинг</a></li>
      <li><a href="#в-боевом-режиме" id="toc-item-clj-book-mutability-в-боевом-режиме">В боевом режиме</a></li>
    </ul>
  </li>
  <li><a href="#немного-о-set" id="toc-item-clj-book-mutability-немного-о-set">Немного о set!</a></li>
  <li><a href="#изменения-в-контексте-binding" id="toc-item-clj-book-mutability-изменения-в-контексте-binding">Изменения в контексте. Binding</a>    <ul>
      <li><a href="#динамические-переменные" id="toc-item-clj-book-mutability-динамические-переменные">Динамические переменные</a></li>
      <li><a href="#отказ-от-set" id="toc-item-clj-book-mutability-отказ-от-set">Отказ от set!</a></li>
      <li><a href="#пример-с-переводом-строк" id="toc-item-clj-book-mutability-пример-с-переводом-строк">Пример с переводом строк</a></li>
    </ul>
  </li>
  <li><a href="#локальные-переменные-в-контексте" id="toc-item-clj-book-mutability-локальные-переменные-в-контексте">Локальные переменные в контексте</a>    <ul>
      <li><a href="#императивный-подход" id="toc-item-clj-book-mutability-императивный-подход">Императивный подход</a></li>
    </ul>
  </li>
  <li><a href="#глобальные-изменения-в-контексте" id="toc-item-clj-book-mutability-глобальные-изменения-в-контексте">Глобальные изменения в контексте</a>    <ul>
      <li><a href="#приложение-с-координатами" id="toc-item-clj-book-mutability-приложение-с-координатами">Приложение с координатами</a></li>
      <li><a href="#тесты" id="toc-item-clj-book-mutability-тесты">Тесты</a></li>
    </ul>
  </li>
  <li><a href="#все-вместе" id="toc-item-clj-book-mutability-все-вместе">Все вместе</a></li>
</ul>

<p>В этой главе мы поговорим про изменяемость данных. Тем, кто программирует на
классических языках, покажется странным, что теме уделено так много
внимания. Причина кроется в дизайне языка. Неизменяемые коллекции – одна из
центральных идей Clojure.</p>

<p class="draft-warn">Внимание! Вы читаете черновик к книге <a href="/clojure-in-prod/">“Clojure на производстве”</a>. Для
книги я переписывал его много раз, но в блоге осталась старая версия. Здесь она
для истории, а вам я рекомендую купить книжку.</p>

<p>В классических языках данные по умолчанию изменяются, а стандартная библиотека
предлагает ограничения: локи, атомарные изменения, постоянные коллекции. Clojure
устроена наоборот: по умолчанию данные не изменяются, а стандартная библиотека
включает несколько техник, чтобы изменять данные. Этим техникам и посвящена
глава.</p>

<p>Руководства по Clojure учат работать с неизменяемыми данными. Это приводит к
тому, что начинающие программисты на Clojure испытывают трудности, когда
возникает потребность менять данные. На время этой главы мы займем
противоположную позицию: рассмотрим, какими способом хранить и управлять
состоянием в программах.</p>


                    <p><a href="/clj-book-mutability/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/clj-exc-video/">Подружиться с исключениями. Видео с митапа</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-06-01T00:00:00+00:00">
        Jun 1, 2019
    </time>

    <a href="/tag/video/" rel="tag">video</a>, <a href="/tag/talks/" rel="tag">talks</a>

</div>


            <div class="entry">
                
                    
<p>В прошлом месяце ездил в Москву, выступал на кложурном митапе. Выкладываю видос
с чистым звуком:</p>

<iframe width="743" height="418" src="https://www.youtube.com/embed/ISANJ69EdvE" allow="accelerometer; autoplay; encrypted-media; gyroscope;
picture-in-picture" allowfullscreen=""></iframe>

<p><a href="https://speakerdeck.com/deeprefactoring/podruzhit-sia-s-iskliuchieniiami-ivan-grishaiev-exoscale">Слайды</a></p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/blog-tags-iv/">Теги и Instant View</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2019-05-17T00:00:00+00:00">
        May 17, 2019
    </time>

    <a href="/tag/blog/" rel="tag">blog</a>, <a href="/tag/update/" rel="tag">update</a>, <a href="/tag/telegram/" rel="tag">telegram</a>

</div>


            <div class="entry">
                
                    
<p>Вчера обновил блог. Первое достижение – появились теги. Я и раньше проставлял
их, но не было возможности искать по ним. Теперь под заголовком каждого поста
указаны его теги. Ссылка по тегу открывает список постов с ним.</p>

<p>Раньше я просто валил посты в кучу, а теперь понял, что надо как-то их
структурировать. Поиск от Гугла хорош, но не дает полной картины. Планирую
сделать разделы по Кложе и Питону, собрать все видео, словом, навести порядок.</p>

<p>Второй прорыв – сделал для блога Instant View в Телеграме. Это когда пост можно
просмотреть прямо в клиенте без перехода на сайт. Это был очень интересный
опыт. Еще не успел ничего автоматизировать, эту заметку заброшу вручную <a href="https://t.me/igrishaev_blog">в
канал</a>. Дальше буду думать. И напишу отдельный пост, как все сделать по
шагам.</p>

                
            </div>

        </li>
        
    </ul>

    <h4>
        
        <a href="/page15" class="previous">&larr;</a>
        
        <span class="page_number ">Страница 16 из 60</span>
        
        <a href="/page17" class="next">&rarr;</a>
        
    </h4>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="tg://resolve?domain=igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
