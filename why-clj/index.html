<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Зачем нужна Кложа</title>
  <meta name="description" content="Когда спрашивают, зачем изучать Кложу, мы слышим что-то неубедительное. Репл,функциональный подход, неизменяемость. Это слабые аргументы. Их нет в мире тех,к...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/why-clj/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod-2/">Книга «Clojure на производстве», второй том</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">

    <h1 class="post-title" itemprop="name headline">Зачем нужна Кложа</h1>

    
<div class="post-meta">

    <time class="post-time"
          datetime="2018-07-27T00:00:00+00:00">
        Jul 27, 2018
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/clojure/" rel="tag">clojure</a>

</div>


  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Когда спрашивают, зачем изучать Кложу, мы слышим что-то неубедительное. Репл,
функциональный подход, неизменяемость. Это слабые аргументы. Их нет в мире тех,
кто годами сидит в императивных языках. Слушатель не понимает, о чем речь, ему и
так нормально. Еще прилепят Рича Хикки, и это уже не смешно. Его имя так
затаскали, что один фанатизм.</p>

<p>Как же ответить, зачем нужна Кложа? Чем подкрепить точку зрения? Примерами из
жизни.</p>

<p>Вчера я стал свидетелем, как типичный кложурист решает задачу машинально, без
раздумий. А программист на императивном языке подвис. Вот как это было.</p>

<p>Сидели в офисе, работали, устали. Захотели почесать языком. Коллега пожаловался
на функцию map в Питоне, и пошло-поехало. В итоге мы вышли на функциональное
программирование и работу с данными в ФП-стиле. Заспорили, как лучше обходить
коллекции.</p>

<p>К моему удивлению, нашлись те, кто вообще не понимал, что можно обрабатывать
массивы данных функционально. Они и предложили задачу. Даны сведения о
программистах, их возраст и рейт. Для каждого возраста нужно подсчитать средний
рейт.</p>

<p>Я сначала не понял, почему это именно задача – в том смысле, почему над ней
нужно думать. Совершенно рутинная вещь, два редьюса. Первый собирает все рейты
по возрасту, второй считает среднее. Вот и все.</p>

<p>Можно свести два в один, как-то оптимизировать, но не суть. Главное, что
кложурист вообще не видит здесь проблемы. Задача уже решена в уме, достаточно
написать код в репле.</p>

<p><img src="/assets/static/aws/1059232/43309405-631a0a60-918d-11e8-853d-de329187fc2e.png" /></p>

<p>Три строчки: входные данные, промежуточный результат, итоговая свертка.</p>

<p>У коллег-императивщиков возникли трудности. Они стали именно думать над задачей,
что-то чертить на доске, обсуждать. Для них это действительно задача, предмет
мозговой деятельности. Мне вскоре понадобилось уйти, так что я не узнал,
получилось ли решить или нет. Факт в том, что решения не было в первую же
минуту.</p>

<p>Если бы я писал этот текст полгода назад, то поместил бы едкий абзац с
травлей. Но сейчас я только сочувствую. Нормально решить эту проблему в Питоне
нельзя. Мапы и редьюсы там кастрированные, в третьей версии редьюс вообще
спрятали в недра библиотек. Во всяких Гоу ничуть не лучше.</p>

<p>Понимаете, нет инструмента! А нет инструмента, нет и понимания, что чего-то не
можешь. Будешь сраться в чате, доказывая, что твой язык клевый. А как же ты
узнаешь как эффективно работать с данными, если в языке ничего для этого нет?
Замкнутая система.</p>

<p>По аналогии со словом: если нет слова, значит, нет целого домена в
сознании. Этой пустоты не видно изнутри, ее можно увидеть только со ступени
выше. Я искренне верю тем, кто пишет, что ему и так нормально. Верю,
нормально. Человек ко всему привыкает. Мы раньше и массив по <code class="language-plaintext highlighter-rouge">i,j</code> обходили и
считали это нормальным. Но это не оправдание лени и нежеланию учиться.</p>

<p>Заглянем на StackOverflow. Каждый второй вопрос по Кложе связан с трансформацией
данных. Типичный пост выглядит так: гайз, у меня вектор векторов мап, надо
перевести в мап векторов мап. Как это сделать? И пример данных: что на входе,
что на выходе. Автору кидают комбо из мап-редьюса, и вопрос закрыт.</p>

<p>Почему так много вопросов именно по работе с коллекциями? Неужели автор не умеет
переводить список в словарь? Скорее всего, Кложа не первый его язык, и он уже
программировал раньше.</p>

<p>Дело не в том, что в Кложе трудно обрабатывать коллекции. Наоборот, это
сильнейшая ее сторона. Разница в том, что на этот раз автора заставили делать
это правильно. Отсюда ломка.</p>

<p>Вспомним, как мы работаем с данными в императивном языке? Скажем, обходим список
словарей. Начинается педерастия. Создаются списки и словари для накопления
промежуточных данных. Код пробегает по коллекции три раза, хотя достаточно
одного. Данные мутабельны, одни и те же ключи словаря перетираются.</p>

<p>В итоге, наплодив лишних переменных, обложившись костылями, императивный
программист выходит на нужный результат. Решил задачу, но код лапша, все
хрупкое. Внезапно, входная коллекция была изменена, пошли баги.</p>

<p>В Кложе нельзя так, просто нельзя. В ней есть изменяемые коллекции и стейт, но
это высокая планка. Язык так устроен, что если ты взялся что-то менять, то
подружись сперва с неизменяемостью.</p>

<p>Вы, наверное, скажете, что на вашей работе не нужно возиться с коллекциями. Но у
меня коллекции постоянно. В кложе нет классов, объектов, наследований и всей
мишуры. Все данные, неважно откуда их взяли – из файла, базы или сети – это
комбо из векторов и словарей. Их нужно колбасить из одного вида в
другой. Постоянно. Почти весь код – это операции с коллекциями.</p>

<p>Пришел от пользователя джейсончик? Нужно взять определенные ключи, состряпать
мапу и положить в базу. Потом взять из базы другие данные. Плоский вектор мап
перестроить в дерево и отдать пользователю. Это надо делать быстро, на автомате,
без временных коллекций и счетчиков. Если подвисать на каждом обходе, то я
вообще хз как вы работаете.</p>

<p>Возвращаясь к вопросу из заголовка – Кложа нужна затем, чтобы научиться
работать с данными. Чтобы при одном только виде коллекции мозг автоматом выдавал
комбо из map, reduce и filter.</p>

<p>Если вы пишете только на императивных языках, то скорей всего, не умеете
работать с данными. Вам нормально, но вы не умеете. Не умеете, но вам
нормально. Такой вот замкнутый круг. Это не страшно, и я до Кложи не умел.
Посмотрел старый код на питоне и ужаснулся.</p>

<p>Нет трудности в том, чтобы сесть за Кложу на недельку и повтыкать, как работать
с данными. Мир после этого станет другим.</p>

  </div>

</article>

<center>
    <p>
        <small>Нашли ошибку? Выделите мышкой и нажмите Ctrl/&#8984;+Enter</small>
    </p>
</center>






<center>Комментарии</center>

<div id="comments">
  
    <div id="comment-4008803895" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Timur Malikin,
            27th Jul 2018,
            <a href="#comment-4008803895">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Идея заметки понятна и в целом согласен, сам видел как "PHP-программисты" не знали как работать с коллекциями через "святую тройку" filter/map/reduce, хотя все эти функции в языке есть, и вполне пригодны. Есть также сторонние библиотеки которые делают это более человечно.</p>
<p>По поводу остального - почти все что написано можно применить к тому же Erlang или любым другим ФП языкам - работа с коллекциями, ломка мышления и тд. Но! Одна из киллер фич Clojure - это богатый мир Java библиотек, и ты не чувствуешь себя ущербным как в мире Erlang, где ситуация с библиотеками просто ужасна.</p>
<p>Поэтому, в случае Clojure, кроме мышления мы получаем полноценно развитый, с сильным сообществом "промышленный" язык, а не просто увлекательную игрушку для узкого круга задач.</p>
</div>
    </div>
  
    <div id="comment-4008858043" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Rrader,
            27th Jul 2018,
            <a href="#comment-4008858043">link</a>
            
          </em>
        </small>
      </p>
      <div><p>&gt;В кложе нет классов, объектов, наследований и всей мишуры<br />А как же классы, объекты, наследования из Java?</p>
</div>
    </div>
  
    <div id="comment-4008871496" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Ivan Grishaev,
            27th Jul 2018,
            <a href="#comment-4008871496">link</a>
            , <a href="#comment-4008858043">parent</a>
          </em>
        </small>
      </p>
      <div><p>Оно есть. Но все это относится к термину inter-op, и с точки зрения данных неважно. Оно нужно лишь чтобы завести Кложурную машинерию, ну и порой слазить в кишки Джавы за чем-то нужным.</p>
</div>
    </div>
  
    <div id="comment-4008961064" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Илья Василевский,
            27th Jul 2018,
            <a href="#comment-4008961064">link</a>
            
          </em>
        </small>
      </p>
      <div><p>По тем же причинам можно взять Ruby и так же прекрасно жить :)</p>
</div>
    </div>
  
    <div id="comment-4008964164" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Rrader,
            27th Jul 2018,
            <a href="#comment-4008964164">link</a>
            
          </em>
        </small>
      </p>
      <div><p>А если я уже знаю filter/map/reduce и применяю в Java, то Clojure не нужен?</p>
</div>
    </div>
  
    <div id="comment-4008968394" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Никита Толкачев,
            27th Jul 2018,
            <a href="#comment-4008968394">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Не понял, как из того факта, что мап, редьюс и фильтр удобны при работе с данными, следует, что нужна кложа.<br />И не понял, как тем ребятам, которые не смогли, помешал питон. Твои два редьюса заменить на два цикла, вот и все. Ты не думал над задачей не из-за кложи, а потому что это очень легкая задача. У тех ребят проблема по ту сторону экрана.</p>
</div>
    </div>
  
    <div id="comment-4008979807" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Dan Kozlov,
            27th Jul 2018,
            <a href="#comment-4008979807">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Я вообще продакт-менеджер, который кодит на питоне на выходных из интереса, почему я решил задачу за 30 секунд, а императивные программисты не осилили?</p>
<p><a href="https://pastebin.com/Vd6kxTC6" rel="nofollow noopener" title="https://pastebin.com/Vd6kxTC6">https://pastebin.com/Vd6kxTC6</a></p>
</div>
    </div>
  
    <div id="comment-4008995960" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Abbath,
            27th Jul 2018,
            <a href="#comment-4008995960">link</a>
            
          </em>
        </small>
      </p>
      <div><p>На все готовы лишь бы recursion schemes  не использовать :)</p>
</div>
    </div>
  
    <div id="comment-4009009745" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Vladimir Gordeev,
            27th Jul 2018,
            <a href="#comment-4009009745">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Всё-таки не раскрыта тема почему именно Кложа. Из статьи понятно что и C# с его LINQ вполне замена.</p>
</div>
    </div>
  
    <div id="comment-4009039473" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Михаил,
            27th Jul 2018,
            <a href="#comment-4009039473">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Спасибо за дельный совет! Обязательно начну учить кложу, потому что однажды кто-то смог на ней решить ОДНУ задачу быстрее, чем кто-то другой</p>
</div>
    </div>
  
    <div id="comment-4009152828" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Mikhail Khorpyakov,
            27th Jul 2018,
            <a href="#comment-4009152828">link</a>
            , <a href="#comment-4008979807">parent</a>
          </em>
        </small>
      </p>
      <div><p>Во-первых, условия задачи были другие.<br />Во-вторых, подвисли мы на моменте подсчёта ассимптотической сложности вычислений.<br />В-третьих, вот тайминги по трём решениям включая ваше (с доработкой в соответствии с оригинальными условиями задачи) на одном миллионе элементов:<br /><a href="https://uploads.disquscdn.com/images/c813ab536d991ab1314ec99715112f8a1d185a386d673102b4d04e02efab655a.png" rel="nofollow noopener" title="https://uploads.disquscdn.com/images/c813ab536d991ab1314ec99715112f8a1d185a386d673102b4d04e02efab655a.png">https://uploads.disquscdn.c...</a><br />Если бы функциональный подход давал такую же производительность и вычислительную эффективность как императивный, мы бы давно увидели закат нефункциональных языков.</p>
</div>
    </div>
  
    <div id="comment-4009163107" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Lens,
            27th Jul 2018,
            <a href="#comment-4009163107">link</a>
            , <a href="#comment-4008803895">parent</a>
          </em>
        </small>
      </p>
      <div><p>я писал на PHP, помню как на заре, я в одном проекте написал на PHP несколько кейсов с использованием функционального подхода, везде вместо циклов и прочего использовал array_map/filter/reduce, на что мне мой тогдашний тимлид заявил чтобы я так не писал больше.</p>
<p>Тогда я не понял, сейчас я это понимаю, не все могут сходу читать такой код и в голове иметь представление о результате выполнения. Ну и как следствие, там где язык позволяет писать ООП или императивно, вам скорее всего попросту не дадут использовать функциональный подход по целому ряду причин. Например - мешанина будет, если один пишет в ФП стиле, остальные в ООП и циклах. Поэтому зачастую эти возможности в PHP попросту не используются. Хотелось бы думать что именно по этой причине он мне не дал оставить тот код.</p>
<p>Преимущество кложи в том, что код на кложе, и есть данные, а данные и есть код. <br />Гомоиконность. Но вот как это объяснить другим? :) Поэтому кложа удобна для трансформации данных, чем тот же Эрланг.</p>
<p>Мне кажется к этому можно прийти только самому. Я, работая как раз с PHP, очень быстро начал уставать от этого всего, и пришел к кложе. Оторвать меня было уже невозможно. Сейчас пишу на кложе и вспоминаю PHP и ООП как страшный сон. Надеюсь он мне больше не приснится.<br />Раньше у меня были попытки объяснять друзьям и коллегам, что это, зачем это, но я бросил попытки. Задал себе вопрос "Зачем?" и понял, что, не то что мне - им это не нужно. Тем людям которым нужно, сам придут, спросят.</p>
</div>
    </div>
  
    <div id="comment-4009194861" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Dan Kozlov,
            27th Jul 2018,
            <a href="#comment-4009194861">link</a>
            , <a href="#comment-4009152828">parent</a>
          </em>
        </small>
      </p>
      <div><p>&gt; условия задачи были другие<br />Условие: "Для каждого возраста нужно подсчитать средний рейт"<br />У меня возвращается кортеж возраста и среднего по этому возрасту рейта. Где я неправ?</p>
<p>&gt; вот тайминги по трём решениям включая ваше<br />Мне кажется, только глупый будет спорить с тем, что питон — это ебучий тормоз в мире программирования ¯\_(ツ)_/¯<br />Если бы у меня был миллион айтемов, я бы использовал pandas и numpy. Писать пример лень, но он не проиграет по таймингам кложуре, обещаю (только инициироваться будет полчаса). В последний раз, когда я играл с pandas и Jupyter Notebook, он у меня ворочал 20М строк в таблице без заметного лага.<br />Но в реальной жизни у меня не бывает миллиона айтемов в памяти. Может, у меня просто примитивные задачи, но всегда, когда у меня возникают миллионы айтемов, они… как правило в базе. А там SQL сделает за меня свои мапы и редюсы лучше, чем любая кложура, питон, руби и все остальные вместе взятые.</p>
<p>Кстати, я не ставил себе задачей написать оптимально. Хотелось написать читаемый однострочник, в противовес тому ужасу из скриншота у автора, я вот вообще нифига не понимаю, лол.<br />Это ж питон, тут всем насрать на производительность.</p>
</div>
    </div>
  
    <div id="comment-4009212981" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Mikhail Khorpyakov,
            27th Jul 2018,
            <a href="#comment-4009212981">link</a>
            , <a href="#comment-4009194861">parent</a>
          </em>
        </small>
      </p>
      <div><p>Требовалось найти максимальный из всех средних рейтов по возрастам. Замеры в одном файле на Питоне. Вот полный код файла который мы использовали для замеров: <a href="https://gist.github.com/khorpy/f6341484b7bffc6003f4d36b074e6ee4" rel="nofollow noopener" title="https://gist.github.com/khorpy/f6341484b7bffc6003f4d36b074e6ee4">https://gist.github.com/kho...</a>. Справедливости стоит заметить, что в первом варианте используется массив а не словарь, что и даёт некий прирост к производительности.</p>
</div>
    </div>
  
    <div id="comment-4009253781" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Dan Kozlov,
            27th Jul 2018,
            <a href="#comment-4009253781">link</a>
            , <a href="#comment-4009212981">parent</a>
          </em>
        </small>
      </p>
      <div><p>Теперь понятнее, что за три решения. Я сперва подумал, что вы перфоманс питона сравнили с кложурой, даже немного возмутился про себя.</p>
<p>Ваши решения автор осудит за императивную болтливость и промежуточные списки. Моё с этой точки зрения чистое, но очень медленное. Не надо давать себя втягивать в такие споры, в них победителем не выйдешь никогда.</p>
</div>
    </div>
  
    <div id="comment-4009565347" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Kir,
            27th Jul 2018,
            <a href="#comment-4009565347">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Haskell is fine, too</p>
</div>
    </div>
  
    <div id="comment-4009808320" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Alexander Popov,
            27th Jul 2018,
            <a href="#comment-4009808320">link</a>
            , <a href="#comment-4008961064">parent</a>
          </em>
        </small>
      </p>
      <div><p>Люблю Ruby за возможность откинуть "промежуточные данные"!</p>
<p><a href="https://repl.it/repls/FinancialRegularSolaris" rel="nofollow noopener" title="https://repl.it/repls/FinancialRegularSolaris">https://repl.it/repls/Finan...</a></p>
</div>
    </div>
  
    <div id="comment-4010276307" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Flamefork,
            28th Jul 2018,
            <a href="#comment-4010276307">link</a>
            , <a href="#comment-4009039473">parent</a>
          </em>
        </small>
      </p>
      <div><p>...для некоторых значений слова "быстрее"</p>
</div>
    </div>
  
    <div id="comment-4010280831" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Konstantin Alekseev,
            28th Jul 2018,
            <a href="#comment-4010280831">link</a>
            
          </em>
        </small>
      </p>
      <div><p>идиоматик питон <a href="https://twitter.com/kvalekseev/status/1022918953839063041" rel="nofollow noopener" title="https://twitter.com/kvalekseev/status/1022918953839063041">https://twitter.com/kvaleks...</a></p>
</div>
    </div>
  
    <div id="comment-4010331674" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Mike Ananev,
            28th Jul 2018,
            <a href="#comment-4010331674">link</a>
            
          </em>
        </small>
      </p>
      <div><p><a href="https://uploads.disquscdn.com/images/13133b0956dd7f4887d49530f5ad7eec48797aaee7a36bbd7e062be99681ab93.png" rel="nofollow noopener" title="https://uploads.disquscdn.com/images/13133b0956dd7f4887d49530f5ad7eec48797aaee7a36bbd7e062be99681ab93.png">https://uploads.disquscdn.c...</a></p>
<p>решение на Clojure через group-by в одну строку.</p>
</div>
    </div>
  
    <div id="comment-4010674525" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Namynnuz,
            28th Jul 2018,
            <a href="#comment-4010674525">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Исходя из «описания», абсолютно не ясно, что именно требуется. Средний рейт чего? Всех программистов данного возраста? А результат должен быть словарём? Или достаточно списка туплов? Вот, значит, Go и Python плохие, кастрированные. И... Всё? Больше языков нет? В том числе и императивных? Я так и не понял, почему нужна Clojure, если абсолютно то же самое решается в C# таким же коротким LINQ-запросом. Только синтаксис не заставляет твои глаза кровоточить (представил в виде именованных туплов, можно было словарём спокойно, и работает оно с такими же списками, IEnumerable&lt;t&gt;; и не надо мне рассказывать про правильное сравнение double, да): <a href="https://i.imgur.com/ELLn3sk.png" rel="nofollow noopener" title="https://i.imgur.com/ELLn3sk.png">https://i.imgur.com/ELLn3sk...</a></p>
</div>
    </div>
  
    <div id="comment-4012609451" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            cactus,
            30th Jul 2018,
            <a href="#comment-4012609451">link</a>
            , <a href="#comment-4010674525">parent</a>
          </em>
        </small>
      </p>
      <div><p>Зато здесь заставляет кровоточить глаза и руки количество строк (и символов в каждой).<br />В итоге мы видим в вашем комменте, с одной стороны, опровержение посыла статьи (потому что сам запрос, вроде как, норм), а с другой — подтверждение превосходства окололиспов в целом и кложи в частности с точки зрения количества сущностей, которые необходимо держать в голове в каждый момент времени. Здесь явно видно, что в сишарпе их слишком много даже в такой простейшей операции.</p>
</div>
    </div>
  
    <div id="comment-4013424347" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Namynnuz,
            30th Jul 2018,
            <a href="#comment-4013424347">link</a>
            , <a href="#comment-4012609451">parent</a>
          </em>
        </small>
      </p>
      <div><p>О да, ведь три строчки это таааак много, просто голова отваливается... -_-<br />Давай хотя бы сравним количество символов и различных маловразумительных синтаксических элементов. Может ещё F# обсудим? Там это будет ещё короче и чище. При том, что он функциональный, но тоже нифига не LISP. И все эти «страшные длинные сущности» вводятся двумя-тремя символами + TAB.<br /><a href="https://i.imgur.com/TOzJ9oC.png" rel="nofollow noopener" title="https://i.imgur.com/TOzJ9oC.png">https://i.imgur.com/TOzJ9oC...</a></p>
</div>
    </div>
  
    <div id="comment-4026783708" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Denis Kovalev,
            7th Aug 2018,
            <a href="#comment-4026783708">link</a>
            , <a href="#comment-4009152828">parent</a>
          </em>
        </small>
      </p>
      <div><p>@dkzlv:disqus Иван сильно утрирует в постановке задачи: нужно было найти максимальный средний рейт полученный для каждого из возрастов и сделать это на питоне в одну строку а-ля "100% функционально", используя только map/reduce/max/sum, не используя foreach, groupby, Counter и прочий сахар работы с коллекциями.</p>
</div>
    </div>
  
    <div id="comment-4035271292" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Василий Колесников,
            11th Aug 2018,
            <a href="#comment-4035271292">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Очень!<br />Как будто читаю свои собственные мысли.</p>
</div>
    </div>
  
    <div id="comment-4035275724" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Василий Колесников,
            11th Aug 2018,
            <a href="#comment-4035275724">link</a>
            , <a href="#comment-4009808320">parent</a>
          </em>
        </small>
      </p>
      <div><p>Чем обусловлен instance_exec?</p>
</div>
    </div>
  
    <div id="comment-4035772898" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Alexander Popov,
            12th Aug 2018,
            <a href="#comment-4035772898">link</a>
            , <a href="#comment-4035275724">parent</a>
          </em>
        </small>
      </p>
      <div><p>Отсутствие переменных для `sum` и `size`.</p>
</div>
    </div>
  
    <div id="comment-4554418822" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Serhii Khalymon,
            26th Jul 2019,
            <a href="#comment-4554418822">link</a>
            
          </em>
        </small>
      </p>
      <div><p>У меня не компилится код со статьи выше:</p>
<p><code>(def data [{:age 18 :rate 30} {:age 12 :rate 22} {:age 33 :rate 22}])<br /><br /><br />(def _temp (reduce (fn [res item] (update res (:age item) conj (:rate item))) {} data))<br /><br /><br />(reduce-kv (fn [acc k v] (assoc acc k (average v))) {} _temp)</code></p>
<p>Syntax error compiling at (REPL:1:39).<br />Unable to resolve symbol: average in this context</p>
</div>
    </div>
  
    <div id="comment-4557874885" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Ivan Grishaev,
            29th Jul 2019,
            <a href="#comment-4557874885">link</a>
            , <a href="#comment-4554418822">parent</a>
          </em>
        </small>
      </p>
      <div><p>Потому что нужно определить функцию average, в коробке ее нет</p>
</div>
    </div>
  
    <div id="comment-5020866454" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Dmitry Ponyatov,
            6th Aug 2020,
            <a href="#comment-5020866454">link</a>
            , <a href="#comment-4009152828">parent</a>
          </em>
        </small>
      </p>
      <div><p>Очень просто -- вы просто принципиально не понимаете как писать неограниченно быстрые программы на функциональных языках 8) впрочем, функцианальщики тоже ведут себя как страусы -- не хотят высунуть голову из своего REPLа, и заглянуть хотя бы на хх.рю<br />Ключ -- не нужно решать _задачу_ на ФЯ. На нём нужно писать модель задачи, и <b>компилятор модели</b> в низкоуровневый язык (С/С++, LLVM, Java, что-угодно-в-проде).<br />Clojure (Racket, Haskell,..) принципиально не нужно тащить в прод, и не нужно показывать вашему работодателю или заказчику что вы им вообще пользуетесь -- им будет достаточна ваша эффективность по генерации кода на mainstream языке, используемом в команде. Вся мощь ФП может раскрыться в коммерческо-прикладном смысле на этапе проектирования, только в форме метапрограммирования, когда вы сами автоматизируете создание своих 50-70-95% рутинного кода.</p>
</div>
    </div>
  
    <div id="comment-5289473053" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Michael T,
            3rd Mar 2021,
            <a href="#comment-5289473053">link</a>
            , <a href="#comment-4008979807">parent</a>
          </em>
        </small>
      </p>
      <div><p>Нет, groupby работает только на отсортированных данных.<br />Да и mean лишнее делает, из-за него по сути тормозит.</p>
</div>
    </div>
  
    <div id="comment-1691951630398" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Мопс,
            13th Aug 2023,
            <a href="#comment-1691951630398">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Отличный пример! Только тег “clojure” нужен, а не “clj”. Иначе до поста не добраться.</p>

</div>
    </div>
  
    <div id="comment-1691954459587" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            Ivan Grishaev,
            13th Aug 2023,
            <a href="#comment-1691954459587">link</a>
            
          </em>
        </small>
      </p>
      <div><blockquote>
  <p>Только тег “clojure” нужен, а не “clj”. Иначе до поста не добраться.</p>
</blockquote>

<p>Поправил.</p>

</div>
    </div>
  
</div>









<form id="comment-form" method="POST" action="https://functions.yandexcloud.net/d4ehfuf08fjfjr59ivnf">

    <div class="block">
        <p class="comment-form-label"><small>Your name</small></p>
        <input required id="comment-form-author" name="author" type="text">
    </div>

    <div class="block">
        <p class="comment-form-label"><small>Comment (markdown syntax)</small></p>
        <textarea required id="comment-form-comment" name="comment"></textarea>
    </div>

    <input required name="path" type="hidden" value="/why-clj/">
    <input required name="captcha" type="hidden" value="6 &#215; 9">

    <div class="block">
        <span class="comment-form-label"><small>6 &#215; 9 = </small></span>
        <input required id="comment-form-solution" name="solution" type="text">
    </div>

    <div class="block">
        <button id="comment-form-send" type="submit">Send</button>
    </div>

</form>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="tg://resolve?domain=igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
