<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Win-win</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/win-win/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px"><a href="/">Ivan Grishaev's blog</a></p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/open-source/">Open Source</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod-2/">Книга «Clojure на производстве», второй том</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">

    <h1 class="post-title" itemprop="name headline">Win-win</h1>

    
<div class="post-meta">

    <time class="post-time"
          datetime="2022-10-27T00:00:00+00:00">
        Oct 27, 2022
    </time>

    <a href="/tag/win-win/" rel="tag">win-win</a>, <a href="/tag/%D0%BF%D0%B5%D1%80%D0%B5%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D1%8B/" rel="tag">переговоры</a>

</div>


  </header>

  <div class="post-content" itemprop="articleBody">
    
<p>Читаю книгу Егора <a href="https://www.piter.com/product/nash-kod-remeslo-professiya-iskusstvo">“Наш код”</a>. Хорошая книга, местами спорная, но ничего — просто держите в голове, что это Егор. Есть, однако, момент, мимо которого я не мог пройти молча — это эпизод с переговорами между двумя группами.</p>

<p>Я хотел привести оригинальный текст, однако электронной версии, откуда можно скопировать и вставить, в интернете нет. Поэтому расскажу завязку своими словами.</p>

<p>Есть группа разработчиков, которые пилят REST API, и есть группа потребителей. Понадобилась доработка сервиса, и потребители выдвигают условие: чтобы новые данные можно было забрать одним запросом. Разработчикам сервиса это неудобно: они сделали несколько новых методов, полагая, что потребители пошлют несколько запросов. Группы не сошлись во мнении, и начинается совещание.</p>

<!-- more -->

<p>Герой книги относится к группе разработчиков. Он рассуждает о переговорах и рассказывает о потенциальных исходах: <strong>win-lose</strong>, когда одна сторона выиграла, а другая проиграла; <strong>lose-lose</strong>, когда из-за компромисса обе группы согласились на неудобные им решения; и наконец <strong>win-win</strong> — стороны пришли к наилучшему для себя решению.</p>

<p>Совещание идет по этим стадиям. Глава потребителей, азиат Бао, требует, чтобы сервис отдавал данные одним запросом. Это win-lose, потому что груз падает на плечи разработчиков. Адриан, их глава, торгуется: предлагает уменьшить число запросов с пяти до трех. Это lose-lose, потому что обе стороны вынуждены дорабатывать свой код, плюс уменьшение числа методов не решает главного конфликта: метод должен быть один.</p>

<p>И вот стороны находят решение, которое герой книги расценивает как <strong>win-win</strong>. Расширить один из написанных методов необязательным параметром. Если он передан, вдобавок к старым данным метод добавляет новые.</p>

<p>Теперь когда вы знаете сюжет, объясните мне, где здесь win-win и почему так считает герой книги? Спрашиваю, потому что никакого win-win нет не только в этой ситуации — его не существует в мире.</p>

<p>Если вы читали Джима Кемпа, то наверное помните, что половину книги он борется со стратегией win-win, доказывая, что она приводит к проигрышу. Я бы не повторял этот тезис, если бы не убедился в его правоте. Никакого win-win не бывает. Сложные переговоры не могут завершиться решением, которое одинаково устраивает всех. Если бы такое решение было, не понадобились бы и преговоры! Это же очевидно.</p>

<p>На практике одной из сторон всегда приходится уступить. Другими словами, win-win — это завуалированный win-lose, при этом lose приходится на ту сторону, которая искренне верит, что получила win. Если оппонент предлагает решение и утверждает, что это win-win, перед вами манипулятор. Win достанется только ему.</p>

<p>Сказанное не значит, что в каждых переговорах нужно стоять насмерть. Иногда приходится уступать, при этом из уступки можно извлечь пользу. Например, если доработка на моей стороне ничтожна, я соглашусь, сделав вид, что взваливаю на себя огромную ношу. В будущем это окупится: дадут премию, увеличат отпуск или освободят от внеурочной работы. Но в терминах переговоров это win-lose, потому что я взял обязательства к удовольствию другой стороны.</p>

<p>Вернемся к ситуации из книжки. Какие вышли итоги? Группа Бао хотела один вызов к сервису и получила его. Для них это однозначный win. Группе Адриана выпала доработка сервиса так, чтобы при необязательном параметре метод возвращал новые данные. Герой книги оценивает это как win, потому что API Адриана остался “правильно” спроектированным и его репутация не пострадала.</p>

<p>Тот, кто писал и поддерживал API, знает, что опциональные параметры крайне нежелательны. Каждый такой параметр порождает развилку if/else в коде, что усложняет его понимание. Больше ветвлений → больше кода → больше багов. Опциональный аргумент требует больше тестов. Исправляя уже написанный метод, есть шанс сломать его и выкатить ошибку на прод, особенно если не было тестов — а именно этот случай описан в книге.</p>

<p>Наконец, поведение, когда метод возвращает X, а при foo=true — связку (X + Y), говорит о плохом дизайне API. Каждый метод должен делать что-то одно, в том числе возвращать данные одной семантики. Если метод <code class="language-plaintext highlighter-rouge">GET /users</code> выводит пользователей и статистику покупок, он явно избыточен. Старому методу пришили вторую голову, но от этого он не стал лучше. Пишу это по следам похожих историй, когда в отлаженный API добавляли “маленький необязательный параметр”, от которого сложность росла кратно.</p>

<p>Кроме вреда от win-win, Кемп пишет о том, как важно придерживаться миссии на переговорах. Миссия — это не сиюминутная цель вроде “показать уродам, кто здесь главный”. Миссию Адриана можно сформулировать так: грамотно развивать сервис платежей, избегая спонтанных решений, с целью как можно дольше поддерживать код в читаемом виде, чтобы с легкостью адаптировать требования бизнеса.</p>

<p>Длинновато, но суть ясна. Как ясно и то, что решение о новом параметре противоречит миссии. Если бы Адриан следовал ей, вот что он бы сказал Бао.</p>

<p><em>Я понимаю вашу просьбу насчет одного метода. Вам будет легче получить данные в коде. В то же время это усложнит код на нашей стороне. Кроме того, существующий метод работает уже долго, на него завязаны бизнес-процессы, а прошлые разработчики не написали тесты. Если мы будем его исправлять, придется сначала покрыть его тестами, что задержит выпуск версии. Чтобы успеть в срок, мы сделаем отдельный метод или несколько. А если у ваших сотрудников будут сложности с их вызовом, придем на помощь: скинем образцы кода, ответим на все вопросы.</em></p>

<p>Вот ответ человека, который понимает миссию и не ждет win-win. Как видите, при таком раскладе группа Адриана не взваливает на себя всю работу, а делит ее равномерно с командой Бао. Если учесть, что изначально Бао рассчитывал на обратное — всю работу проделают разработчики — это win Адриана и lose Бао. Все сходится, чудес не бывает.</p>

<p>Но в книге не так: Бао получил один запрос, группа Адриана выкатила неуклюжий метод “два в одном”. А поскольку герой относится к группе Адриана, я не понимаю, где здесь win. Может быть, вы понимаете?</p>

<p>В заключение напомню про книжку Кемпа. Горячо советую прочитать хотя бы первую ее половину. Тезисы удивительно точны и подтверждаются жизнью.</p>

    
<div class="prev-next">

    <div class="prev-next-left">
    
        <p><small><a href="/preview/">&larr; Программа Preview</a></small></p>
    
    </div>

    <div class="prev-next-mid">
    </div>

    <div class="prev-next-right">
    
        <p><small><a href="/autocomplete/">Автодополнение &rarr;</a></small></p>
    
    </div>

</div>

  </div>

</article>

<center>
    <p>
        <small>Нашли ошибку? Выделите мышкой и нажмите Ctrl/&#8984;+Enter</small>
    </p>
</center>





<center>
    
    Комментарии
    
    
</center>



<div id="comments">
  
    <div id="comment-1671557332501" class="comment-block">
      <p class="comment-lead">
        <small>
          <em>
            То-сё-пятое-десятое,
            20th Dec 2022,
            <a href="#comment-1671557332501">link</a>
            
          </em>
        </small>
      </p>
      <div><p>Только что закончил чтение “Сначала скажите «нет». Секреты профессиональных переговорщиков”  Джима Кэмпа.
Очень понравилось.</p>

<p>Спасибо за рекомендацию книги.</p>

<p>Применительно к разработке ПО, многие идеи тоже применимы.
Например, явно осозновать что мы контролируем, а что нет.</p>

<p>Вообщем книга заставляет задуматься.</p>

<p>Например, я бы предпочел понимание того какой код
является сложным, а какой (более) простым;
как определять что важно, а что нет
вместо, например, информации об SOLID и UML.</p>
</div>
    </div>
  
</div>









<form id="comment-form" method="POST" action="https://functions.yandexcloud.net/d4ehfuf08fjfjr59ivnf">

    <div class="block">
        <p class="comment-form-label"><small>Your name</small></p>
        <input required id="comment-form-author" name="author" type="text">
    </div>

    <div class="block">
        <p class="comment-form-label"><small>Comment (markdown syntax)</small></p>
        <textarea required id="comment-form-comment" name="comment"></textarea>
    </div>

    <input required name="path" type="hidden" value="/win-win/">
    <input required name="captcha" type="hidden" value="9 &#215; 5">

    <div class="block">
        <span class="comment-form-label"><small>9 &#215; 5 = </small></span>
        <input required id="comment-form-solution" name="solution" type="text">
    </div>

    <div class="block">
        <button id="comment-form-send" type="submit">Send</button>
    </div>

</form>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="https://t.me/igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
