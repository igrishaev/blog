---
layout: post
title: "Бусти и почта"
permalink: /boosty/
tags: boosty email google
---

Подписался на одного человека в Бусти — первый раз пользовался этой
платформой. Заодно наблюдал котовасию с подтверждением почты.

Дело было так: захожу через Гугло-учетку, все нормально, пришло письмо
"здравствуй, дорогой Ivan". А как начал читать, появилась плашка: чел,
`ivan@grishaev.me` — это твой емейл?

Вы серьезно? Гугл уже подтвердил, что это моя почта, что вам еще нужно? Как вы
это представляете: зашел через Гугл, а почта не моя? Тыкаю Yes, чтобы
отвязался. Перехожу в соседнюю вкладку, а там вылезла та же плашка. На этот раз
я промахнулся и нажал No. В результате моя почта пропала из профиля, и Бусти
пишет — пока не подтвердишь почту, покоя не дам.

Хоть я и не видел кода Бусти, легко понять, почему так происходит. Когда
создается учетка, у нее стоит флаг "почта не подтверждена" — нормальное
поведение для регистрации по email. Но разработчики не учли, что в случае с
Гуглом почта подтверждается автоматом и выносят мозг подтверждением.

На ровном месте устроили бурю в стакане: подтверди, хотя никакого подтверждения
не нужно. Большой и денежный сервис, а такие косяки.

Интересный факт об авторизации, который я не знаю, куда приткнуть, поэтому пусть
будет здесь. Когда пользователь входит через Фейсбук, он может отказать в
передаче емейла. В результате вам прилетит джейсончик, где всякие
токены-шмокены, а почты нет. Если почта критична (а это чаще всего так),
приходится заворачивать пользователя со словами "не быкуй, галочку не
снимай". Требует много кода и тестов.
