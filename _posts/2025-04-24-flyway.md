---
layout: post
title: "Flyway"
permalink: /flyway/
tags: flyway postgres
telegram_id: 808
---

Волею судеб я использую джавную библиотеку Flyway для миграций. Должен сказать:
ее писали клоуны.

Вот как это проверить: запускаем миграции на Postgres 15.8, версия Flyway
7.5.4. Все благополучно работает. А если поднять версию до последней 11.7.2,
получим исключение:

> Unsupported Database: PostgreSQL 15.8

Не менял абсолютно ничего, никаких настроек, только бампнул версию. И вот
пожалуйста.

Внимание, вопрос: что же такого случилось, что Постгрес 15.8 вдруг не
поддерживается? Почему спустя три мажорных релиза он отвалился? Слишком новый?
Слишком старый? И что делать?

Между прочим, Постгрес 15.8 — относительно свежий релиз (последняя версия, если
что — 17). С каких щщей он попал в немилость?

Что творилось в голове у джавистов, которые писали Flyway, я ума не приложу.

Мне приходилось писать свои миграционные движки, и могу сказать: да, это работа
не на один день, конечно. Хорошенько все потестить, а потом стабилизация. Но
наколбасить 11 мажорных релизов, которые вдобавок тупо не работают — это надо
уметь.

Сюда же относится официальный SDK AWS на Джаве, который я уже
упоминал. Ощущение, что писали студенты или вроде того. Все аргументы
опциональны, все может быть null, в том числе бакет, который читаешь, или файл,
в которых пишешь. В рантайме ловишь сто ошибок, что это не может быть нул, то не
может и так далее. Про обязательные аргументы в Амазоне не слышали.

Выпустили SDK 2, а там те же самые проблемы.

Словом, ты вырос и сказка кончилась. Программист в корпорации X может получать
400 тыс. долларов в год и писать лютейший быдлокод. А нам, потребителям, с этим
жить.
