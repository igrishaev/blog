---
layout: post
title: "Системный дизайн"
permalink: /sys-disign/
tags: programming system design interview
telegram_id: 885
---

В айти есть забавная вещь – собеседование а-ля "систем-дизайн". Компании выносят
ее в отдельный собес наравне со скринингом, алгоритмами и так далее. Теперь
наряду с красно-черными деревьями надо помнить, как задизайнить убийцу Твиттера
или Ютуба. За ночь перед собесом покупается книга Алекса Сюя, штудируется, и
наутро кандидат рисует ноды в Кубернетисе с Кафкой в кластере.

Когда-то систем-дизайн был не везде, и это можно было стерпеть. Но сегодня он в
повсеместно – от Гугла до КолымВодоканала. С приходом в массы систем-дизайн
превратился в ритуал или проще говоря – в клоунаду.

Так, ритуал предполагает, что нужно сделать аналог Твиттера. При этом нельзя
сразу писать код или рисовать диаграммы. Нужно задать интервьюеру вопросы:
сколько пользователей в день, сколько они пишут твитов, сколько селебрити
(людей, чья популярность резко выше остальных), сколько датацентров и так
далее. Потом цифры перемножаются, чтобы получить размер данных на
диске. Например, умножим миллион юзеров на пять твитов, на 100 байтов, ~~на
число цилиндров, на длину сектора...~~

Как вы поняли, эти цифры взяты с потолка и отношения к реальности не
имеют. Нельзя построить сервис, который посещают миллион пользователей в день
сразу после открытия. Так не бывает, если у вас нет другого такого же
сервиса. Но вас не пустят к рисованию схем, пока вы не посчитаете цифры.

Представляю: сели и посчитали, что на хранение данных понадобится петабайт
данных. Идем такие к инвестору и говорим: мистер Джонс, дайте ундециллион
долларов на пять датацентров с петабайтами дискового хранилища, бекапы на
магнитной ленте в Арктике, ну и столько же для тренировки AI. Да, убийца
Твиттера, успех 100%, мы все посчитали.

Слушайте, хорошо дизайнить петабайты данных и датацентры на Луне! Дорого-богато,
ни в чем себе не отказываем. А попробуй задизайнить, когда горизонт бюджета —
шесть зарплат. Весь дизайн разбивается о реальность: база с кафкой на одной
ноде, бекапы не делаем, потому что некогда и дорого, логи грепаем в терминале.

Если серьезно, то на такие ресурсы денег никто не даст – если вы не
господрядчик, конечно. Скажут – выкати минималку, приведи хотя бы сто тысяч
пользователей, потом и поговорим. И это правильный подход.

А во-вторых, когда нас просят задизайнить Твиттер, Инстаграм или Ютуб, забывают
одну мелочь – **ни один из этих сервисов не дизайнили по этому принципу**.
Каждый айти-гигант начинался со стартапа с сотней детских болезней. Твитер в
молодости был поделкой на Руби и падал чаще, чем работал. Гугл вышел из
гаража. Первый Яндекс работал на личном компе одного из разрабов и
перезагружался, когда тот толкал его ногой. Каждый сервис прошел особый путь
роста, и рассчитать его на бумажке – все равно что запланировать жизнь ребенка:
во столько-то лет он поступит сюда, выйдет на работу туда, вступит в брак с
тем-то. Это глупость, потому что в жизни все оказывается не так.

Сегодня стартапы начинают с гексагонных архитектур, сине-зеленого деплоя и так
далее. Увы, часто этого хватает на год-два, не больше. Счета за Амазон съедают
выручку, и даже когда компания спохватится, бывает поздно. Я работал в стартапах
и знаю это не по рассказам друзей, а видел воочию. Систем-дизайн буквально
съедает бизнес. Лично слышал от основателя фирмы: "мы не будем возражать, если
вы найдете другую работу".

Кроме того, даже Гугл со своими мощностями порой не может раскрутить
сервисы. Может, помните Google Wave, прообраз современной Слаки? Общество было
не готово к формату, и проект закрылся. То же самое произошло с Google Buzz,
аналогом Твиттера. Он продержался два года. Не сомневаюсь, что в Гугле очень
точно перемножили число людей на длину сообщения, но что-то пошло не так. Еще
пример – Google Video, там Гугл просто капитулировал и понял, что проще купить
Ютуб, чем делать платформу самому.

Так что систем-дизайн стал очередным ритуалом, который нужно выучить и
пройти. Еще одна боль для тех, кто хочет поменять работу или войти в
айти. Разумеется, читая Сюя, можно узнать много полезного – это справедливо для
любой книги в принципе. Но делать из ритуала культ – это глупо.
