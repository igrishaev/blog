---
layout: post
title:  "ИИ-ревью"
permalink: /ai-review/
tags: ai review work
---

Верьте аль не верьте, но в одном проекте у нас было ИИ-ревью. Слушайте.

Фирма назначила нового технического директора. Уже первый разговор с ним посеял
тревогу. Его технический стек не имел отношения к тому, что был у нас. Он сходу
предложил перейти на MongoDB — оставив за кадром факт, что переезд с гигантской
базы Постгреса занял бы несколько лет. Он много говорил о Chat GPT и о том, как
ИИ-ревью изменит наши процессы.

Начальство дало добро, и техдир провел три месяца, настраивая ИИ-ревью. Если
вкратце, оно работало так.

Нашелся бот на Node.js, который парсит дифф и выдирает изменения. Бот крутится в
CI и запускается на каждом коммите.

Выдрав изменения и собрав контекст, бот отправлял все добро в Chat GPT и
составлял отчет.

Этот отчет добавлялся в комментарий к пулл-реквесту.

Звучит круто, а что было на самом деле? Это выглядело так. По каждому файлу бот
писал: добавлена такая-то функция, переименован такой-то параметр, функция
foo-bar теперь принимает три аргумента, а не два. И все таком духе:
человекоподобное описание изменений. Ниже он писал вердикт — хороши ли изменения
или требуют доработки.

Постарайтесь это представить: в пул-реквесте пятнадцать файлов, и по каждому бот
пишет абзац текста. Получается портянка на два экрана, совершенно тупая и
бесполезная. Что с того, что написано "добавлена новая функция"? Я из без бота
вижу, что она добавлена. Вполне может быть, что похожая функция уже есть, либо
это могло быть inline-выражение, либо есть лучшая версия этой функции в
библиотеке? Бот ничего об этом не знал.

Открывая PR, ты первым делом видел выхлоп ИИ на два экрана. Нужно было
проматывать эту фигню, чтобы добраться до кода.

Получилась своего рода версия PR для менеджеров. Ну, знаете, бывает версия для
слабовидящих, а есть версия для менеджеров. Менеджер не может прочесть код, и
система генерит ему описание: добавилось то, убавилось это. Читая выхлоп,
менеджер думает, что понимает код, хотя это не так. Он понимает действие, но не
понимает причины, не понимает смысла, который стоит за этим кодом.

Чтобы портянка на два экрана не мешала, я стал удалять ее из PR. В том числе не
только из своих PR, но и коллег, если меня просили сделать ревью. Открывая PR, я
рассчитываю увидеть код, а не машинный выхлоп, пусть даже его произвел ИИ. И
знаете, никто не жаловался на удаление. Скоро я заметил, что коллеги молча
удаляют этот комментарий без моего вмешательства.

Стоит ли говорить, что бот ничего не знал о безопасности и хороших практиках. Он
спокойно пропускал места, где SQL-параметр подставлялся склейкой строк. Он
ничего не знал о reflection warning, о кривых запросах, неэффективных циклах,
запросах мимо индекса.

Удивлял его вердикт: бот мог написать "все отлично" к файлу, к которому у меня
было три претензии. Мог написать "требует доработки" к файлу, где все
гладко. Само собой, без каких-либо объяснений, что именно требует доработок и
каких.

Получался молчаливый бойкот: разработчики не обращали внимания на бота, техдир
ничего в Кложе не понимал, а бот не давал ответа на вопрос, хороший мы пишем код
или нет.

Добавлю, что еще раньше техдир хотел подключить в CI сторонний говносервис,
который делает то же самое. К счастью, в списке поддерживаемых языков не было
Кложи.

И вот однажды бота отключили. Я не стал спрашивать о причинах: они были
очевидны. ИИ-ревью не оправдало себя, а директор потратил три месяца на его
настройку. Ничего не изменилось в лучшую сторону, стало только хуже, потому что
добавился новый компонент, усложнился CI, были потрачены деньги. Позже директора
уволили.

В чем была его ошибка? В том, что он не мог четко объяснить, какую проблему он
решал с помощью ИИ. Я уже писал про это: принимаясь за задачу, спрашивай себя,
какую проблему ты решаешь. В том проекте у нас было хорошее ревью: никто не
затягивал процесс, сложные диффы смотрели несколько человек. В команде была
компетенция в плане Кложи и SQL. Словом, ревью было последним местом, куда бы я
внедрил ИИ.

Вот что бывает, когда за дело берутся менеджеры. Их стремление автоматизировать
понятно: вдруг человек уйдет, а мы такие внедрили ИИ, и ладушки: он с нами
навсегда. Увы, это не работает: есть процессы, которые должен выполнять
человек. Всякие ИИ могут быть страховкой, но не более того.
