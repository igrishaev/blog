---
layout: post
title: "Пиши, улучшай"
permalink: /write-and-check/
tags: programming code
---

Кто читал Ильяхова, знает формулу "пиши, сокращай". Суть в том, что хороший
текст не пишут сразу. Пишется болванка, полная косяков, а потом по ней
многократно проходят: здесь снимают стружку, тут, наоборот, доливают
свинца. Только тогда текст становится сильным.

То же самое с кодом: недостаточно его написать и проверить. Когда тесты написаны
и код рабочий, нужно пройтись по нему и причесать. Дать нормальные имена,
вынести анонимные функции на верхний уровень. Одни участки кода разнести на
промежуточные шаги, чтобы не было слишком плотно. Другие, наоборот, сократить.

Здесь нет точных правил, важно чутье — как воспримет этот код другой
человек. Будет ему ли понятна логика, насколько легко внести изменения.

И если есть программисты, которые комитят рабочий код, то со второй фазой все
очень плохо. Кажется, что когда код заработал, у программиста щелкает какое-то
реле — работа сделана, закрывай таску. Потратить двадцать минут на причесывание
кода — не знаем, не слышали.

И да, этим страдают в том числе кложуристы. Кто-то напел им, что на Кложе
получается божественный код, который хорош сам по себе. Иммутабельность, лисп,
дэ-эс-эль, бла-бла.

Читаю чужой код: коллекцию пропускают через пачку `map` и `partition-by`. В
каждой из них — анонимная функция со вложенными reduce и другими анонимными
функциями. Партицирование замкнуто на другой коллекции, которая что-то достает
из первой. Неделимый блок кода размером с экран. Функция в функции внутри
функции.

Нечитаемый ад. Писал его не молодой программист, надо полагать, с опытом. И то
же самое: как только он дошел до стадии "работает", то оформил PR — и получил
апрув коллег.

Давайте не будем так делать. Если код работает, это не значит, что задачу пора
закрывать. От двадцати минут, потраченных сверху, вреда не будет — прод не
сгорит, менеджер подождет. Зато спасет день коллеги, который вкатывается в
проект.
