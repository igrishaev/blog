<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ivan Grishaev's blog</title>
  <meta name="description" content="Writing on programming, education, books and negotiations.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod-2/">Книга «Clojure на производстве», второй том</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">

    <ul class="post-list">
        
        <li>

            <h2>
                <a class="post-link" href="/solid-context/">SOLID и контекст</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-27T00:00:00+00:00">
        Jan 27, 2025
    </time>

    <a href="/tag/solid/" rel="tag">solid</a>

</div>


            <div class="entry">
                
                    <p>Когда говорят про SOLID, забывают вот о чем. Принцип SOLID — типичный пример,
когда контекст, в котором возникло явление, важнее самого явления.</p>

<p>SOLID возник в момент, когда в ООП-тусовке царил упадок. До повсеместного
перехода на ООП говорили, что объекты решат все проблемы. Достаточно выразить
сущности классами и нарисовать UML-схему — и все станет понятно. Звучит примерно
как “Земля плоская”, но тогда в это верили. И когда ООП-модель стала буксовать,
придумали SOLID, чтобы вдохнуть в нее новую жизнь.</p>

<p>У SOLID есть даже не аналогия, а буквальный пример из жизни. Каждый тренер
знает, что главное у спортсмена — настрой (разумеется, не исключая питание и
тренировки). Если настрой в упадке, есть не совсем честные способы его
поднять. Скажем, когда команда проигрывает всухую, тренер берет таймаут и выдает
“заряженные” клюшки, которыми играли великие спортсмены. Или переставляет
участников местами, говоря, что сейчас будем играть по “секретной”
тактике. Поскольку спортсмены суеверны, это работает.</p>

<p>Та же самая история у военных, полицейских, пожарных. У них есть церемонии
раздачи “заряженных” девайсов, например, касок погибших героев. Надевая такую
каску, боец буквально получает +100 к отваге. Вопрос о том, действительно ли
герой носил эту каску, тактично обойдем стороной.</p>

<p>С принципом SOLID то же самое. Когда стало ясно, что нагромождение классов не
решает прошлых проблем, а только добавляет новых, кто-то придумал SOLID. Посыл в
том, что отныне мы не блуждаем в потемках, а идем к некой цели. Пишем не просто
быдлокод, а по некой методичке. И пусть она спорна и расплывчата, это неважно —
есть ориентир. Спортсмен снова мотивирован и готов брать рубежи.</p>

<p>Поэтому отношение к SOLID у меня спорное. Смысловая составляющая высосана из
пальца, но запал колоссальный. Уже десятки лет люди спорят о том, как писать код
по SOLID правильно. В этом смысле я снимаю перед создателем шляпу, потому что
ведь надо так уметь! — вдохновить толпы народа без какой-либо конкретики.</p>

<p>Но у любой легенды есть запас прочности, и актуальность SOLID подходит к
концу. Я понимаю, когда о нем пишут в рекламных блогах или курсах для
новичков. SOLID — это все и ни о чем, универсальный рецепт, из которого можно
выжать тысячи текстов. Но удивляет, когда кто-то всерьез рассуждает о том, как в
2025 году писать код по SOLID. Здесь можно сказать одно: как бы ни держалась
стюардесса, ее пора закопать.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/solid-abbrev/">SOLID и другие аббревиатуры</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-27T00:00:00+00:00">
        Jan 27, 2025
    </time>

    <a href="/tag/solid/" rel="tag">solid</a>, <a href="/tag/anal-sex/" rel="tag">anal-sex</a>

</div>


            <div class="entry">
                
                    <p>Читатель Дмитрий снял с языка одну мысль, которую я приберег для отдельной
заметки. Если коротко, все удачные аббревиатуры вроде SOLID, как правило,
высосаны из пальца. Вероятность, что первые буквы пяти слов образуют другое
емкое слово, равна нулю. Поэтому слова подгоняют под аббревиатуру.</p>

<p>Другими словами, сначала придумывают емкий термин, затем под каждую букву ищется
слово. Разумеется, за уши притягивают лишние слова, как например принцип Liskov,
который никому не сдался. Но без Liskov не получилось бы слова, поэтому пришлось
взять.</p>

<p>В своем комментарии Дмитрий приводит пример. Берем выразительную аббревиатуру,
например ANALSEX и просим чат-ГПТ придумать расшифровку. Чат справился
прекрасно:</p>

<ul>
  <li>
    <p><strong>A: Abstraction</strong> Focus on hiding complex implementation details and exposing
only essential features.</p>
  </li>
  <li>
    <p><strong>N: Normalization</strong> Ensure that data structures and databases are designed
efficiently, avoiding redundancy.</p>
  </li>
  <li>
    <p><strong>A: Automation</strong> Prioritize automating repetitive tasks and workflows to
increase efficiency and reduce errors.</p>
  </li>
  <li>
    <p><strong>L: Loose Coupling</strong> Design components to have minimal dependencies, making
systems more modular and easier to maintain.</p>
  </li>
  <li>
    <p><strong>S: Scalability</strong> Build systems capable of handling growth in users, data,
and operations effectively.</p>
  </li>
  <li>
    <p><strong>E: Encapsulation</strong> Keep implementation details private within modules or
classes, exposing only necessary interfaces.</p>
  </li>
  <li>
    <p><strong>X: eXpandability</strong> Design with future growth and adaptability in mind,
ensuring that new features can be added without major rewrites.</p>
  </li>
</ul>

<p>Особенно хорош последний пункт. Слов на X мало, поэтому чат выделил вторую букву
в eXpandability.</p>

<p>И главное, все по делу: абстракции — нужны, автоматизация — нужна,
масштабирование — нужно, расширяемость — тоже. Не прикопаешься. Так что всем
внедрять ANALSEX! Обсудите с коллегами и расскажите начальству.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/edocs/">Электронные квитанции</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-27T00:00:00+00:00">
        Jan 27, 2025
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/planet/" rel="tag">planet</a>

</div>


            <div class="entry">
                
                    <p>Иногда снабжающие организации присылают письма:</p>

<blockquote>
  <p>Иван Викторович!</p>
</blockquote>

<blockquote>
  <p>Давайте беречь бумагу и планету! Перейдем на электронные квитанции во имя
добра. Согласны? Если да, откройте файл из вложения, заполните и отправьте.</p>
</blockquote>

<p>Конечно, я за природу, планету и все такое. Открываю файл <code class="language-plaintext highlighter-rouge">?????????????.doc</code> из
вложения, смотрю, а там: укажите ФИО, адрес, юридический адрес, ИНН, реквизиты
счета, телефон, номер и дату договора, почту, а еще — название документооборота
и фирму-эмитент электронной подписи. Всего-то…</p>

<p>Смотрю на этот файл минуту, а потом отправляю в корзину вместе с письмом. До
следующего раза.</p>

<p>Хочется спросить: ребята, если вам так нужно перетащить меня в какую-то систему,
нельзя ли этому поспособствовать? Скажем, поручить кодеру Васе написать скрипт,
который вытащит мои данные из базы — я указывал их при заключении договора — и
состряпает PDF, который останется только подписать. Что, нельзя так?</p>

<p>Наверняка эти письма рассчитаны на биг-боссов, которые пересылают их секретарше
Леночке со словами “разбери это дерьмо”. Но у меня нет секретарши, и тратить час
на заполнение Ворда я не хочу.</p>

<p>Самое забавное — фирма уже высылает документы по электронной почте, но вдобавок
зачем-то кладет в почтовый ящик распечатки толщиной с палец. Уже который раз
пишу им, мол, перестаньте слать бумагу, электронка вполне устраивает. Но им
нужно заявление в Ворде.</p>

<p>Удивительно, как быстро у людей деформируются мозги в больших фирмах.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/the-fuck/">The Fuck</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-24T00:00:00+00:00">
        Jan 24, 2025
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/python/" rel="tag">python</a>, <a href="/tag/fuck/" rel="tag">fuck</a>

</div>


            <div class="entry">
                
                    
<p>Может быть, вы не знали, но есть программа с выразительным названием <a href="https://github.com/nvbn/thefuck">The
Fuck</a>. Написана на Питоне, 90 тысяч звезд, работает следующим образом.</p>

<p>Предположим, вы запустили что-то в терминале, но получили ошибку. Не указан
такой-то флаг, это депрекейтед, то-се. Если ввести <code class="language-plaintext highlighter-rouge">fuck</code>, то программа считает
предыдущую команду и повторит ее, но на этот раз правильно.</p>

<p>Звучит непонятно, так что рассмотрим пример. Скажем, я сделал новую ветку и хочу
запушить ее на сервер:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout -b ssl-no-validation
git add .
git commit -m "some changes"
git push
</code></pre></div></div>

<p>Вот что я получу:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fatal: The current branch ssl-no-validation has no upstream branch.
To push the current branch and set the remote as upstream, use

    git push --set-upstream origin ssl-no-validation
</code></pre></div></div>

<p>Гит прекрасно понял, что я имел в виду, но предлагает ввести команду
повторно. Если же ввести <code class="language-plaintext highlighter-rouge">fuck</code>, то утилита считает bash_history и выполнит то,
что нравится Гиту.</p>

<p>В последнем Гите это починили: теперь <code class="language-plaintext highlighter-rouge">git push</code> делает апстрим
самостоятельно. Однако долгое время меня выручал fuck.</p>

<p>Сегодня я им не пользуюсь, но вспомнил вот почему. Программа хорошо расширяется
регулярками, и народ собрал целую кладезь fuck-рецептов. Получилась своего рода
энциклопедия бредовых случаев. Мне кажется, они достойны изучения просто затем,
чтобы знать, как делать не надо. Если же ваша программа оказалась среди рецептов
– это нужно быстро исправить.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/postgres-csv/">Постгрес и отчеты</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-24T00:00:00+00:00">
        Jan 24, 2025
    </time>

    <a href="/tag/postgres/" rel="tag">postgres</a>, <a href="/tag/sql/" rel="tag">sql</a>, <a href="/tag/csv/" rel="tag">csv</a>

</div>


            <div class="entry">
                
                    <p>В очередной раз выручил Постгрес.</p>

<p>По работе я много занимаюсь отчетностью: генерю CSV и эксельки со всякими
цифрами. Дело это не хитрое, но много нюансов: нужно собрать данные из десяти
источников, очистить, переколбасить, построить прямые и обратные индексы. В
идеале распараллелить. Потом пробежаться по коллекциям и записать итоговый
документ.</p>

<p>Поскольку дело происходит в лямбде, я очень стеснен в ресурсах и
времени. Процессор медленный, памяти и диска немного, а на выполнение дается не
более 15 минут. Это только кажется много, а на самом деле первые 7 минут уходят
только на то, чтобы скачать архивы.</p>

<p>Из последнего: в папке S3 лежит огромный CSV на 10 миллионов записей. Нужно
выбрать из него одно подмножество, затем второе, а потом склеить их по id =
parent_id.</p>

<p>Написал на Кложе черновик — работает, занимает 11 минут. Можно плюнуть и
оставить, но 11 минут — это уже близко к 15 минутам, а значит, можно получить
таймаут. Переписал с параллельной обработкой — стало 5 минут, волноваться не о
чем.</p>

<p>А потом смотрю и думаю: ты же, дурачок, написал ровно то, что делает база
данных. Только раз в десять медленней и костыльней. Убери быдлокод, загони CSV в
базу и выполни запрос — получишь то же самое.</p>

<p>Так и сделал: получаю из Амазона стрим с CSV-содержимым. Не скачивая его на
диск, направляю прямиком в Постгрес во временную таблицу (апишка COPY FROM
STDIN). Тот загружает 10 миллионов записей за 40 секунд. Потом посылаю SQL с
двумя подзапросами и джоином — результат готов за 15 секунд. Его даже не нужно
писать в CSV самому. Вызываешь COPY TO STDOUT — и Постгрес сам записывает CSV на
диск. Точнее, в стрим, который я направляю в файл.</p>

<p>Минус два экрана быдлокода, быстрее почти на порядок — все довольны, все
смеются. Сразу после этой доработки мне написал один человек — мол, репорт
хороший, только надо еще одну табличку заджойнить. Да не вопрос.</p>

<p>Отсюда мораль — если что-то можно поручить базе, поручайте базе. Постгрес уже 20
лет делает джоины и проекции таблиц. Вероятность того, что вы сделаете быстрее,
стремится к нулю.</p>

<p>Ради интереса глянул на SQLite — зачем брать серверный Постгрес, если можно
локально справиться? Оказалось, SQLite не умеет импортировать CSV. Такая команда
есть в интерактивном шелле, а в протоколе обмена — нет. А в Постгресе есть
потоковый COPY, поэтому выбора не остается.</p>

<p>Есть у нас сервис, который пилят другие люди. Там логика крутится вокруг CSV и
пакетного импорта в другие сервисы. Посмотрел и ужаснулся: километры кложурного
быдлокода можно заменить импортом в базу и парой-тройкой запросов. Дай бог
доберусь, переделаю.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/lol-1c/">Код на русском</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-24T00:00:00+00:00">
        Jan 24, 2025
    </time>

    <a href="/tag/1c/" rel="tag">1c</a>, <a href="/tag/life/" rel="tag">life</a>

</div>


            <div class="entry">
                
                    <p>Я как-то рассказывал про феномен: показываешь человеку код на Лиспе, и он
начинает хихикать, хрюкать, постить смайлики, словом, теряет всякое
лицо. Примерно как школьник, принесший в класс эротический журнал.</p>

<p>Заметил, что такая же ерунда с кодом на 1С. Если где-то всплывет код на русском,
начинаются крики, эмоции… ужасно.</p>

<p><img src="/assets/static/aws/lol-1c/1.jpeg" /></p>

<p>Я писал на 1С три с половиной года в Чите, в славном Энергосбыте. У нас были две
жирные программы: одна на Дельфях, вторая на 1С. Я поддеживал обе, и до сих пор
нежно люблю эти платформы.</p>

<p>Так вот, торжественно заявляю: код на русском поддерживается точно так же, как и
на английском. Разницы нет. Когда читаешь код, то воспринимаешь его как
структурированный набор команд. Никто не читает по буквам
“Если…То… Конец”. Глаз выделяет структуру, операторы, циклы, словом, все как
в обычном языке.</p>

<p>Да, у 1С свои проблемы. Во-первых, язык не отличается врожденной красотой, а
во-вторых, у 1С радикально низкий порог входа. Хотя то же самое можно сказать о
раннем PHP. Еще одна косвенная проблема – 1С стоит особняком от других
технологий, и в результате типичный 1С-программист ничего не знает о протоколох,
безопасности и алгоритмах.</p>

<p>Эти проблемы я признаю и готов обсуждать. Но когда очередной клоун смеется над
кодом с русскими буквами, боюсь, он получит только мое презрение.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/grumping/">Дети в телефонах</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-24T00:00:00+00:00">
        Jan 24, 2025
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/phones/" rel="tag">phones</a>

</div>


            <div class="entry">
                
                    <p>Разговаривал с пожилым человеком, и он выдал следующую мысль. Цитирую
максимально близко.</p>

<blockquote>
  <p>Мы, старики, часто бухтим, что дети сидят в телефонах. А разве пожилые люди
чем-то лучше? Еду в поезде — книги нет ни у кого, все от мала до велика в
телефонах и планшетах. Даже старики, которых в свое время приучали читать. На
работе у нас пять чатов в Вацапе: младшая группа, старшая, родители, педсовет,
бухгалтерия. И все туда пишут, отвечают, спорят. Постят картинки а-ля “с
добрым утром”. Набрасывают политические новости, уже на втором сообщении
переходят на личности. Бывает, три человека стоят в метре друг от друга и
пишут в один чат. Чем они отличаются от детей, которых мы ругаем? Если сами не
можем себя контролировать и каждую минуту открываем телефон, то что требовать
от детей? Они повторяют за нами.</p>
</blockquote>

<p>И я подумал: эту мысль стоит разместить здесь.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/get-money/">Получить деньги</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-24T00:00:00+00:00">
        Jan 24, 2025
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/money/" rel="tag">money</a>

</div>


            <div class="entry">
                
                    <p>Если вы работаете вне штата (контрактор, ИП, самозанятый), то получить даньги с
закачика — ваша работа. Получение денег может быть трудным и долгим, и обычно о
нем не говорят. Но чем раньше вы примите тезис из первого предложения, тем
скорее на вас снизойдет благодать.</p>

<p>Когда вы работаете в штате, волноваться не о чем: зарплата сама падает на
карточку. Даже до карт выдача зарплаты была регламентирована. В назначенный день
бухгалтер вызывает в кабинет и дает деньги под роспись. Все строго, пропускать
нельзя.</p>

<p>Некоторые думают, что у ИП и контракторов то же самое: поработал — получил
деньги. Это не так: сотрудник должен заполнить часы, посчитать зарплату,
выпустить квитанцию и отправить ее нужным людям. Потом ждать и пинать тех, кто
отправляет деньги. Потом пройти валютный контроль в банке: предоставить
документы, контракт, квитанцию, в сотый раз доказать, что все законно. Если
затупить на любом этапе, деньги не придут, и заказчик лишь пожмет плечами: сам
виноват.</p>

<p>Штатные сотрудники полагают, что бухгалтер переводит им зарплату по доброте
душевной. На самом деле бухгалтер делает это из страха перед государством. Дело
вот в чем: с каждой зарплаты фирма платит налог. В России мало об этом думают,
потому что получают зарплату уже после вычета налогов. Но если кому-то не
выплатили зарплату, то и налог с нее тоже не заплатили. Если государство узнает,
что Иванову удержали зарплату, оно накажет фирму — но не за то, что Иванову
нечего есть, а за то, что не уплачен налог.</p>

<p>Получается, что у штатного работника есть “крыша” в виде государства, которая,
разумеется, оказывает свои услуги за ренту. А поскольку ИП платит налоги
по-другому, то волноваться о том, получил он деньги или нет, не нужно. Точнее,
нужно, но в другом ключе: от кого и за какие услуги.</p>

<p>Поэтому напоминаю тем, кто выходит со штатной работы на удаленку: выбивание
денег ложится на ваши плечи. Лучше сразу принять это как данность, чем потом
обвинять всех вокруг.</p>

<p>Понимаю, что заметка немного опоздала из-за, как сейчас пишут, “изменившегося
контекста”. Этот “контекст” нынче такой, что удаленщики возвращаются в штат. Но
лучше поздно, чем никогда. А чтобы заметка не выглядела сухой, расскажу кулстори
о том, как выколачивал деньги.</p>

<p>Все началось хорошо: американский стартап с командой в Европе. Технический
руководитель очень компетентный, полное понимание. Проходит месяц, жду
зарплату. А девушка бухгалтер говорит: не могу отправить платеж, система не
позволяет, то-се. Период оплаты прошел, программа закрыла бюджет, теперь в
следующий раз.</p>

<p>Проходит месяц, девушка выходит замуж и улетает в свадебное
путешествие. Программа автоматом рассылает деньги всем, кроме меня. Жду.</p>

<p>Девушка прилетает через пять недель, раскачивается еще неделю. Договариваемся на
звонок. Разница 12 часов, она шарит экран, я подсказываю, куда какие реквизиты
вводить. Вроде бы норм, деньги должны уйти, но в назначенный день не
уходят. Девушка звонит в свой банк, ей объясняют, как правильно заполнить форму.</p>

<p>Чтобы не томить — на пятый раз деньги ушли и потом приходили стабильно. Но вот
курьез: мне не выплатили четыре зарплаты и делают вид, что все хорошо. Начинаю
осторожные переговоры: мол, заплатите мне эти деньги тоже. А мне говорят: ты не
волнуйся. Когда будешь увольняться, мы тебе все разом выплатим. Нет, говорю,
лучше добавляйте к каждой зарплате бонус, пока не закроем прошлые выплаты. Они
очень неохотно, но согласились.</p>

<p>Возникли вопросы у налоговой: в контракте указано N тысяч фантиков, а приходит
на четверть больше. Как так? Пришлось выставлять квитанции якобы за переработки
и допуслуги.</p>

<p>Но дело шло: мало-помалу долг закрывался. Вот и первую зарплату погасили,
вторую, третью… а потом случилась банальная для стартапа история. Не прошли
очередной раунд ивестиций — и все, денег нет. Собрали звонок и говорят: мы не
будем возражать, если найдете другую работу. Можете работать на нас, но без
каких-либо гарантий выплат.</p>

<p>Я пишу, что за вами осталась одна непогашенная зарплата, на что отвечают —
держись, денег нет. Я решил, что ничего не поделать и был рад хотя бы тому, что
выбил три зарплаты — ведь если бы ничего не делал, то попал бы на все четыре. Но
неожиданно за меня вступился технический руководитель, и последнюю зарплату
все-таки выплатили. Буквально за день или два до того, как банк перестал
принимать платежи из-за границы.</p>

<p>Увы, не все были столь удачливы. Одному коллеге были должны пять зарплат, но за
него никто вступился. Он долго переписывался с финальным боссом, а когда
упомянул про суд, получил примерно такой ответ: делай визу, прилетай в
Калифорнию, нанимай юриста и мы с тобой с радостью посудимся.</p>

<p>Нет смысла повторять тезисы из начала статьи, надеюсь, они понятны. Добавлю, что
о ваших деньгах никто лучше вас не позаботится — вот такая простая мысль.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/telegram-markup/">Разметка в Телеграме</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-20T00:00:00+00:00">
        Jan 20, 2025
    </time>

    <a href="/tag/telegram/" rel="tag">telegram</a>, <a href="/tag/ui/" rel="tag">ui</a>

</div>


            <div class="entry">
                
                    <p>Наверняка вы замечали баг в Телеграме. Написал сообщение, поправил разметку, а
она поехала (см. картинку). Выделил болдом одно, а оказалось помечено другое. То
же самое с моноширинным текстом. Ну а самая печаль — разметка кода. Иногда так
плывет, что проще удалить сообщение и разместить по-новой.</p>

<p><img src="/assets/static/aws/telegram-markup/1.jpeg" /></p>

<p>Дело в том, как передается разметка в Телеграме. Многие полагают, что в нем
маркдаун, но на самом деле это не так. Телеграм может принимать маркдаун от
ботов, но разметка приводится ко внутреннему виду, примерно такому:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{:message "Welcome back, Ivan Grishaev!",
 :entities
 [{:type :text_mention,
   :offset 14,
   :length 13,
   :user {:id 100500 :nickname "igrishaev"}}]}
</code></pre></div></div>

<p>Смысл в том, что есть сообщение и набор размеченных зон. Каждая зона знает
смещение в символах и длину (поля offset и length). У зоны есть тип и
дополнительные параметры, которые влияют на рендер. В примере выше слова “Ivan
Grishaev” будут выглядеть как ссылка на пользователя с нужными атрибутами.</p>

<p>У этой системы следствие: если поправить текст, смещения зон должны быть
скорректированы. Например, я поменял Welcome back на просто Welcome. Пропали
пять символов, и смещения всех зон должны уменьшится на 5. На простых случаях
это работает, но когда зон много (болды, италики и прочее), что-то идет не
так. Возможно, виноват многострочный код: он как-то оптимизируется, а смещения
зон не принимают его во внимание.</p>

<p>Если бы в Телеграме была система тегов вроде markdown или xml/html, такой
проблемы бы не было. Братьям Дуровым, конечно, виднее, но я тоже могу
высказаться.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/prop-more/">Еще о пропаганде</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2025-01-20T00:00:00+00:00">
        Jan 20, 2025
    </time>

    <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/propaganda/" rel="tag">propaganda</a>

</div>


            <div class="entry">
                
                    <p>Я уже писал, как видит Россию западный человек. Для него Россия — это воплощение
повести 1984. На каждом углу висит телевизор, из каждого утюга призывают брать
Берлин.</p>

<p>При этом условного американца не смущает, что владелец Твиттера — первой в мире
площадке обмена мнениями — открыто топит за своего кандидата и подкручивает
алгоритм ленты.</p>

<p>Никого не смущают признания Цукерберга насчет ковидной истерии. Согласно им,
любой анти-ковидный контент опускался в выдаче настолько, что его нельзя было
найти.</p>

<p>Фактически это значит следующее. Если у человека нет долгой истории предпочтений
(игры, котики, гаджеты, etc), то чтение ленты — это и есть потребление
пропаганды. Но для западного человека “это другое”.</p>

<p>Попался текст, который процитирую частично:</p>

<blockquote>
  <p>Европейцы понятия не имеют о России. Российская пропаганда даже внутри страны
вызывает у значительной части населения буквально рвотные рефлексы, если не
брать во внимание психически нездоровую часть общества, крайне нуждающуюся в
ежедневной порции агрессии и ненависти. Но эта часть всегда невелика даже в
среде, которую искусственно разогревают самыми отвратительными
эмоциями. Психика - это такая штука, которая не способна постоянно находиться
в возбужденном состоянии, а пропаганда отрабатывает только один номер
последние пять лет, из которых последние три - на форсаже. Если вас каждый
день на протяжении долгого времени кормить даже самыми вкусными пельменями -
вы скоро их будете буквально ненавидеть. Что уж говорить про пельмени от
российской пропаганды…</p>
</blockquote>

<p>О чем я и говорил. Европеец считает, что россиянин после работы весь вечер
смотрит пропаганду. А на самом деле россиянин смотрит тупые шоу и сериалы. В
мессаджере у него не военкоры, а рекламное говно вроде “как унизить собеседника
одной фразой”, арбитраж крипты, микродозинг, сибирский кузнец, кующий настоящие
ножи.</p>

<p>Кое-что из личных наблюдений. Я вожу дочь в музыкальную школу и порой жду ее в
фойе. Там стоит телевизор, и был упоротый охранник, который смотрел военные
передачи: на сколько километров продвинулись, сколько убили бандеровцев, как
будем делить Украину. К нему всегда подходили родители и просили
выключить. Когда охранника наконец заменили другим, телевизор больше не
включают. Стоит для мебели.</p>

<p>Уже несколько лет хожу в тренажерный зал. Что обсуждают между подходами? Фильмы,
кроссовки, выступления знаменитых качков, телефоны, машины, бухло. Все то, что
интересует обычного мужчину (почему-то ни слова про секс и женщин). Политика
относится к той же области, что и религия: все понимают, что тема чувствительная
и стараются замять, если всплыло. Неадекватов просят помолчать.</p>

<p>Поэтому повторю тезис: кто рассуждает об ужасах чужой пропаганды, пересказывают
свою.</p>

                
            </div>

        </li>
        
    </ul>

    <h4>
        
        <span class="page_number ">Страница 1 из 89</span>
        
        <a href="/page2" class="next">&rarr;</a>
        
    </h4>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="https://t.me/igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
