<!DOCTYPE html>
<html lang="ru">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ivan Grishaev's blog</title>
  <meta name="description" content="Writing on programming, education, books and negotiations.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="canonical" href="https://grishaev.me/">
  <link rel="alternate" type="application/rss+xml" title="Ivan Grishaev's blog" href="https://grishaev.me/feed.xml">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/static/favicons/favicon.ico">

  <script type="text/javascript" src="/assets/typo.js"></script>

</head>


  <body>
    <header class="site-header">

    <div class="wrapper flex-container">

        <div>
            <a href="/">
                <img id="avatar" src="/assets/static/avatar.jpg" alt="Ivan Grishaev">
            </a>
        </div>

        <div class="flex-container-vert" style="margin-left: 15px; width: 80%">

            <div class="flex-container full-width">
                <p style="margin-bottom: 5px">Ivan Grishaev's blog</p>
                <div class="flex-huge"></div>
                <div >
<form id="search-form"
      target="_blank"
      style="display: inline"
      method="get"
      action="https://www.google.com/search">

    <input name="sitesearch"
           value="grishaev.me"
           type="hidden">

    <input type="text"
           required="required"
           name="q"
           placeholder="Google search..."
           autocomplete="off">

    <button style="border: none; background-color: transparent; cursor: pointer;"
            type="submit">&#x1f50d;</button>

</form>
</div>
            </div>

            <p><small>Writing on programming, education, books and negotiations.
</small></p>

            <div class="flex-container">
                <a class="menu-item" href="/">Home</a>
                <a class="menu-item" href="/about/">About</a>
                <a class="menu-item" href="/bookshelf/">Bookshelf</a>
                <a class="menu-item" href="/feed.xml">RSS</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor" href="/tag/clojure/">Clojure</a>
                <a class="menu-item minor" href="/tag/emacs/">Emacs</a>
                <a class="menu-item minor" href="/tag/python/">Python</a>
                <a class="menu-item minor" href="/tag/programming/">Programming</a>
                <a class="menu-item minor" href="/interview/">Interview</a>
                <a class="menu-item minor" href="/video/">Video</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod/">Книга «Clojure на производстве»</a>
            </div>

            <div class="flex-container">
                <a class="menu-item minor hl" href="/clojure-in-prod-2/">Книга «Clojure на производстве», второй том</a>
            </div>

        </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="home">

    <ul class="post-list">
        
        <li>

            <h2>
                <a class="post-link" href="/clj-deed/">Deed: a fast encoding and decoding library for Clojure</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-07T00:00:00+00:00">
        Oct 7, 2024
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/clojure/" rel="tag">clojure</a>, <a href="/tag/encoding/" rel="tag">encoding</a>, <a href="/tag/decoding/" rel="tag">decoding</a>

</div>


            <div class="entry">
                
                    
<h2>

    Table of Content

</h2>

<ul id="toc-item-clj-deed">
  <li><a href="#about" id="toc-item-clj-deed-about">About</a></li>
  <li><a href="#motivation" id="toc-item-clj-deed-motivation">Motivation</a></li>
  <li><a href="#installation--requirements" id="toc-item-clj-deed-installation--requirements">Installation &amp; Requirements</a></li>
  <li><a href="#quick-demo" id="toc-item-clj-deed-quick-demo">Quick Demo</a></li>
  <li><a href="#api" id="toc-item-clj-deed-api">API</a>    <ul>
      <li><a href="#simple-encode-and-decode" id="toc-item-clj-deed-simple-encode-and-decode">Simple Encode and Decode</a></li>
      <li><a href="#encoding-to-memory" id="toc-item-clj-deed-encoding-to-memory">Encoding to Memory</a></li>
      <li><a href="#sequential-encoding-and-decoding" id="toc-item-clj-deed-sequential-encoding-and-decoding">Sequential Encoding and Decoding</a></li>
      <li><a href="#low-level-api" id="toc-item-clj-deed-low-level-api">Low-Level API</a></li>
      <li><a href="#api-options" id="toc-item-clj-deed-api-options">API Options</a></li>
    </ul>
  </li>
  <li><a href="#gzipped-streams" id="toc-item-clj-deed-gzipped-streams">GZipped Streams</a></li>
  <li><a href="#appending-to-a-file" id="toc-item-clj-deed-appending-to-a-file">Appending to a File</a></li>
  <li><a href="#handle-unsupported-types" id="toc-item-clj-deed-handle-unsupported-types">Handle Unsupported Types</a></li>
  <li><a href="#supported-types" id="toc-item-clj-deed-supported-types">Supported Types</a></li>
  <li><a href="#extending-custom-types" id="toc-item-clj-deed-extending-custom-types">Extending Custom Types</a>    <ul>
      <li><a href="#encode" id="toc-item-clj-deed-encode">Encode</a></li>
      <li><a href="#decode" id="toc-item-clj-deed-decode">Decode</a></li>
      <li><a href="#macros" id="toc-item-clj-deed-macros">Macros</a></li>
    </ul>
  </li>
  <li><a href="#handling-defrecords" id="toc-item-clj-deed-handling-defrecords">Handling Defrecords</a></li>
  <li><a href="#contrib" id="toc-item-clj-deed-contrib">Contrib</a>    <ul>
      <li><a href="#base64" id="toc-item-clj-deed-base64">Base64</a></li>
      <li><a href="#vectorz" id="toc-item-clj-deed-vectorz">VectorZ</a></li>
    </ul>
  </li>
  <li><a href="#binary-format" id="toc-item-clj-deed-binary-format">Binary Format</a></li>
  <li><a href="#benchmarks" id="toc-item-clj-deed-benchmarks">Benchmarks</a></li>
</ul>

<h2 id="about">About</h2>

<p>Deed is a library to dump any value into a byte array and read it back. It
supports plenty of types out from the box: Java primitives, most of the Clojure
types, Java collections, date and time, and so on. It supports even such tricky
types as atoms, refs, and input streams. The full list of supported types is
shown in the <a href="#supported-types">“Supported Types”</a> section below.</p>

<p>Deed can be extended with custom types with ease. There is a contrib package
that extends encoding and decoding logic for vectors from the the well-known
<a href="https://github.com/mikera/vectorz">mikera/vectorz</a> library.</p>

<p>Deed is written in pure Java and thus is pretty fast (see the
<a href="#benchmarks">“Benchmarks”</a> section). It’s about 30-50% faster than Nippy.</p>

<p>It doesn’t rely on the built-in Java <code class="language-plaintext highlighter-rouge">Serializable</code> interface for security
reasons. Every type is processed manually.</p>

<p>Deep provides convenient API for reading the frozen data lazily one by one.</p>

<h2 id="motivation">Motivation</h2>

<p>Obviously you would ask why doing this if we already have Nippy? This is what I
had in mind while working on Deed:</p>

<ol>
  <li>
    <p>The library must be <strong>absolutely free</strong> from dependencies. This is true for
the <code class="language-plaintext highlighter-rouge">deed-core</code> package: it’s written in pure Java with no dependencies at
all. By adding it into a project, you won’t blow up you uberjar, nor you will
have troubles with building a native image with GraalVM.</p>
  </li>
  <li>
    <p>Any part of Deed that requires 3rd-party stuff must be a sub-library. So you
have precise control of what you use and what you don’t</p>
  </li>
  <li>
    <p>Unlike Nippy, Deed never falls back to native Java serialization. There is no
such an option. Thus, your application cannot be attacked by someone how has
forged a binary dump.</p>
  </li>
  <li>
    <p>Deed is simple: it blindly works with input- and output byte streams having
no idea what’s behind them. It doesn’t take compression nor encryption into
account – yet there are utilities for streams.</p>
  </li>
  <li>
    <p>The library provides API which personally I consider more convenient than
Nippi’s. Namely, Deed can lazily iterate on a series of encoded data instead
of reading the whole dump at once.</p>
  </li>
  <li>
    <p>Finally, why not using popular and cross-platform formats like JSON, Message
Pack, or YAML? Well, because of poor types support. JSON has only primitive
types and collections, and nothing else. Extending it with custom types is
always a pain. At the same time, I want my decoded data be as close to the
origin data as possible, say, <code class="language-plaintext highlighter-rouge">LocalDateTime</code> be an instance of
<code class="language-plaintext highlighter-rouge">LocalDateTime</code> but not a string or <code class="language-plaintext highlighter-rouge">java.util.Date</code>. Sometimes, preserving
metadata is crucial. To haldle all of these cases, there now a way other than
making your own library.</p>
  </li>
</ol>


                    <p><a href="/clj-deed/">Read more &rarr;</a></p>
                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/world-of-goo-2/">World of Goo 2</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-06T00:00:00+00:00">
        Oct 6, 2024
    </time>

    <a href="/tag/games/" rel="tag">games</a>, <a href="/tag/goo/" rel="tag">goo</a>

</div>


            <div class="entry">
                
                    
<p>Вышла <a href="https://worldofgoo2.com/">вторая часть World of Goo</a>. Я долго не знал об этом, потому что
повестка забита другим, да и на работе зашиваюсь. Однако это самая приятная
новость за последние полгода или около.</p>

<p>Изюминка в том, что с момента первой части прошло шестнадцать лет. И дело не в
том, какая графика или саундтрек в новой части. Просто испытываешь радость за
тех двух парней, которые выкатили продолжение. Такое же чувство испытываешь,
когда любимая группа записала альбом после долгих лет турне.</p>

<p>Шестнадцать лет исполнилось моему старшему ребенку. Помню, как начал играть в
Гушек, когда ему было пять месяцев. Гушек прошли вдоль и поперек двое моих
детей, третьей еще предстоит.</p>

<p>Если вы не играли в первую часть, горячо советую это сделать. Игра — не просто
залипательная казуалка. В ней много попыток что-то донести между строк. Почти
каждый уровень — это метафора на что-то из жизни. Попадаются намеки на
отношения, красоту и любовь. Есть серия уровней в компьютере, где моделируется
перехват трафика, балансировка нагрузки и другие айтишные штучки. Есть длинный
диалог на тему браузерных кук. Ближе к концу — эпичный поворот с удаленными
электронными письмами.</p>

<p>Приятно не только расставлять шарики, но и ловить подсказки, намеки, искать
отсылки. Гушки — настоящее произведение искусства. Спасибо двум парням, которые
заставили часами залипать в этот мир. Прошло шестнадцать лет — и я снова загляну
туда, пусть ненадолго, но с тем же интересом.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/ui-void/">UI и пустота</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-06T00:00:00+00:00">
        Oct 6, 2024
    </time>

    <a href="/tag/ui/" rel="tag">ui</a>, <a href="/tag/emptyness/" rel="tag">emptyness</a>

</div>


            <div class="entry">
                
                    <p><img src="/assets/static/aws/ui-void/1.jpeg" /></p>

<p>Понимаю, что многие не любят подобный контент, но все-таки. На ужасные вещи
нужно обращать внимание, что случайно не сделать так же.</p>

<p>Мне интересно, почему веб превращается в пустыню? На страницах чудовищно много
пустоты. Кругом жирные отступы, блоки помещаются в прямоугольники с обводкой, те
– в другие прямоугольники и так далее рекурсивно. И всюду отступы, отступы,
отступы. Стало нормой, что на первом экране ничего не вмещается – только слои
всяких виджетов и жирная блямба посередине. Нужно проматывать ради одной строки.</p>

<p>Фронтендеры, что же с вами случилось?</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/lambda-thinking/">Мышление лямбдами</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-06T00:00:00+00:00">
        Oct 6, 2024
    </time>

    <a href="/tag/aws/" rel="tag">aws</a>, <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/lambda/" rel="tag">lambda</a>

</div>


            <div class="entry">
                
                    <p>В проекте, который плотно сидит на Амазоне, я познакомился с новой для себя
вещью: мышлению лямбдами. Это когда на каждый чих создается лямбда, и кто-то ее
вызывает: бекенд, фронтенд, очередь или хук, повешенный на бакет.</p>

<p>Раньше я об этом не думал, но оказалось, что лямбда — самый сложный продукт
Амазона. В экосистеме AWS лямбды повсюду. Их можно приделать к любому
сервису. Загрузил файл в S3 — дернулась лямбда. Поднялся инстанс EC2 — дернулась
лямбда. Лямбда может быть обработчиком очередей SNS и SQS. Это универсальный
клей, которым можно соединить что угодно.</p>

<p>Лямбда может создана на любой технологии: на Джаве, на Го, на баше. Она может
быть голым бинарником или скриптом на Питоне или Ноде. В последних случаях ее
код можно поместить прямо в yaml-конфиг Cloud Formation.</p>

<p>Ситуация, когда лямбда вызывает лямбду, та вызывает лямбду, та вызывает лямбду,
которая пишет файл в S3, и на это событие вызывается лямбда, уже не кажется
абсурдом. Поначалу шокирует, но привыкаешь.</p>

<p>Другой случай: как поднять инстанс EC2 на заданное количество времени? А вот
как: дернуть лямбду и передать ей число секунд, скажем, 7200 (два часа). Лямбда
запустит инстанс из образа, после чего запишет в S3 файл с числом оставшихся
секунд. В облаке работает шедулер, который каждые 5 минут запускает другую
лямбду. Эта лямбда читает число секунд из бакета, вычитает из него 300 секунд и
записывает обратно. Если время истекло, она дергает третью лямбду, которая
убивает инстанс. Вот такие многоходовочки.</p>

<p>Сперва у меня было чувство, словно я рассматриваю картины Сальвадора
Дали. Первая реакция — что, так можно было? Оказалось да, можно. С этим живут,
это поддерживают, на этом зарабатывают деньги. Такие схемы даже работают. Тех,
кто их проектирует, называют AWS-архитекторами.</p>

<p>Все это я понимаю и принимаю. И все же малодушно хочу, чтобы такого было меньше.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/bucks/">Баки</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-06T00:00:00+00:00">
        Oct 6, 2024
    </time>

    <a href="/tag/english/" rel="tag">english</a>

</div>


            <div class="entry">
                
                    <p>Со словом “баксы” (доллары) интересная ситуация. Bucks — это уже множественная
форма слова buck. Один доллар — один бак. Получается, что два доллара — это два
бака. Поэтому вместо “ы” на конце нужно склонять по правилам русского языка.</p>

<p>То же самое со словом “чиксы”. Дословно chiks означает “цыплята”, и это уже
множественная форма. В переносном смысле оно означает девушек, ищущих мужского
внимания. По аналогии, если “чикс” — множественная форма, то единственная будет
“чик” или “чика”.</p>

<p>Потренируемся: Алексей показал бумажник, полный баков. За ним увязались модные
чики. Все чики любят наличные баки. В Пятерочке сказали, что не принимают баки,
только рубли. Чики ушли от Алексея к Михаилу. У него нет баков, зато полно
рублей.</p>

<p>Хм, как-то непривычно.</p>

<p>Из комментариев в Телеграме: рельсы (рели), чипсы (чипы), джинсы (джины),
комиксы (комики).</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/air-drop/">AirDrop</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-10-06T00:00:00+00:00">
        Oct 6, 2024
    </time>

    <a href="/tag/airdrop/" rel="tag">airdrop</a>, <a href="/tag/macos/" rel="tag">macos</a>

</div>


            <div class="entry">
                
                    <p>В интересном мире мы живем. Казалось бы, функция AirDrop не требует интернета,
работает автономно за счет локального файфая и блютуза. И все равно — кинуть
файл с ноута на мобилу проще через Телеграм. А это, на минуточку, отправка файла
бог весть куда, его обработка на сервере, скан на вирусы, индексация меты и
загрузка обратно. Приличный такой раунд-трип.</p>

<p>И все равно это быстрее, чем радиосвязь между двумя устройствами, расстояние
между которыми полметра.</p>

<p>Был же комикс xkcd, где чел говорит: пока ты будешь регистрироваться в Dropbox,
я уже с флешкой приеду. С AirDrop что-то из этой оперы: пока он сканит девайсы,
Телеграм уже давно прожевал файл.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/yandex-price/">Подорожание Яндекса</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-09-30T00:00:00+00:00">
        Sep 30, 2024
    </time>

    <a href="/tag/yandex/" rel="tag">yandex</a>, <a href="/tag/life/" rel="tag">life</a>, <a href="/tag/music/" rel="tag">music</a>

</div>


            <div class="entry">
                
                    <p>Как вы знаете, Яндекс поднял цену на подписку «Плюс». Это событие обсуждалось на
всех площадках. Теперь когда интернет отпустило, выскажусь и я.</p>

<p>Дело вот в чем: людей взбесил не факт подорожания, а лицемерное письмо, которое
разослал Яндекс. Оно и стриггерило пользователей.</p>

<p>Письмо написано в таком ключе: ребята, мы тут думали-думали, как бы сделать вам
хорошо, всю голову сломали. И решили добавить в подписку никому не нужный сервис
А и никому не нужный сервис Б.</p>

<p>И это не все! В сервисе В появилась такая-то фигня, в сервисе Г – такая-то.</p>

<p>И лишь в третьем абзаце упоминается пустяковая деталь: подписка повышается в два
раза, следующее списание тогда-то.</p>

<p>Читаешь и чувствуешь испанский стыд. Копирайтеры Яндекса <em>действительно
считают</em>, что если новость о повышении задвинуть в третий абзац, то ее не
заметят. Что клиент Яндекса – однозадачный человек, который держит в голове одну
мысль. Если закинуть ему новость про сервисы, то подорожание он проигнорирует.</p>

<p>Это так глупо и дешево! Словно вернулись на десять лет в прошлое, когда
копирайтеры верили в разные техники и манипуляции, чтобы управлять читателем.</p>

<p>Клиент Яндекса – это городской образованный человек среднего возраста. Ежедневно
он читает много сообщений и прекрасно знает эти фокусы. Даже если он не может
обозначить их явно, в письме чувствуется фальшь: главное задвинули в конец, а
незначительное стоит впереди, чтобы запорошить глаза.</p>

<p>Каждому, кто прочел это письмо, ясно, что повышение цен и было главной
новостью. Ведь так? Кого обманывает Яндекс? Главное должно быть вначале.</p>

<p>О повышении цен нужно писать явно. Сервисы регулярно поднимают цены, например,
тот же Гугл. При этом он не пишет лицемерных писем, не пытается прикрыться
новыми сервисами. Все просто: чуваки, через три месяца подписка станет семь
долларов вместо пяти. Клиенты такие: ну ок.</p>

<p>Вот как можно было написать:</p>

<blockquote>
  <p>Дорогой Иван, мы повышаем цену на подписку Плюс. Было столько-то, через три
месяца станет столько-то. Это необходимо, чтобы поддерживать и развивать
продукты Яндекса.</p>
</blockquote>

<blockquote>
  <p>Чтобы вы не расстраивались, мы добавили никому не нужные сервисы А и Б, а
также фичи В и Г в таких-то сервисах. Ссылки на биллинг и прочая информация.</p>
</blockquote>

<p>Словом, Яндекс эпично провалился с этим письмом. Еще не научились копирайтеры
Яндекса общаться с аудиторией.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/yaml-files/">Файлы Yaml</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-09-30T00:00:00+00:00">
        Sep 30, 2024
    </time>

    <a href="/tag/programming/" rel="tag">programming</a>, <a href="/tag/yaml/" rel="tag">yaml</a>, <a href="/tag/aws/" rel="tag">aws</a>

</div>


            <div class="entry">
                
                    <p>Пару дней назад я славно покувыркался с yaml-файлами.</p>

<p>Значит, есть два репозитория с плейбуками Ansible. Нужно добавить в каждый файл
новую таску. Копирую и вставляю в первый — все в порядке. Копирую во второй, и
на CI лезут ошибки парсера.</p>

<p>Смотрю, а дело вот в чем: в первом файле были отступы в два пробела. В том
куске, что я копировал, было тоже два, поэтому он сел без проблем. А во втором
файле кто-то использовал четыре пробела. Вставил таску где-то посередине, и
пожалуйста: ParserException on line 63, position 15. Тупил над этим десять
минут, еще десять минут заняла вторая неудачная итерация, в итоге через полчаса
починил.</p>

<p>Ну и вообще, ямл — он такой ямл. Когда плоская мапа, выглядит красиво, вопросов
нет. Но когда у тебя вектор мап векторов мап, это просто ад. Все эти минусики и
двоеточия сливаются в общую массу, и если нужно перенести кусок с одного уровня
на другой — все, тушите свет. А бородатым девопсам с километрами ямла это
нормально: у них ансиблы и кубернетисы всякие.</p>

<p>Более общая мысль — значимые отступы были ошибкой. Идея, что мы уберем фигурные
скобки и заменим пробелами, выглядит красиво только на первый взгляд. За красоту
нужно платить — чаще всего, падающими билдами или скрытыми багами, когда мапа
уехала не туда.</p>

<p>Разумеется, вы готовы предъявить: в Питоне отступы и он популярен. Съел? Все
равно считаю, что пробелы — это ошибка. Когда я занимался Питоном, у нас были
свои кулстори на эту тему. Например, оператор return уехал из-под условия или в
критический патч закрался таб — и наложение этого патча положило прод.</p>

<p>Я как-то уже писал: хорошо, когда форма имеет явные начало и конец. Чтобы не
было контекста, в рамках которого нужно гадать, закончилась форма или нет. Для
обозначения границ можно взять скобки. И получится…, стойте, это же… о
щи-и-и..!</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/avatars/">Аватарки</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-09-30T00:00:00+00:00">
        Sep 30, 2024
    </time>

    <a href="/tag/avatars/" rel="tag">avatars</a>

</div>


            <div class="entry">
                
                    <p>Не люблю аватары, где люди изображены во время выступления со сцены. То есть
когда микрофон, бейджик, взгляд мимо камеры вдаль, блики в глазах от софитов,
руки застыли в каком-то жесте.</p>

<p>Это гнилой пафос. Двадцать лет назад конференции были штучными, и попасть туда
можно было только по блату. Сегодня кто угодно может выступить где угодно. Когда
я смотрю на аватару выступающего, представляю, как он предлагает перейти на
MongoDB или переписать все на Раст. Ну или похожий бред.</p>

<p>Человек с микрофоном на аватаре напоминает кису с новым айфоном. Глупый китч. Не
надо так.</p>

                
            </div>

        </li>
        
        <li>

            <h2>
                <a class="post-link" href="/apple-time-2/">Сбой времени (2)</a>
            </h2>

            
<div class="post-meta">

    <time class="post-time"
          datetime="2024-09-30T00:00:00+00:00">
        Sep 30, 2024
    </time>

    <a href="/tag/apple/" rel="tag">apple</a>, <a href="/tag/time/" rel="tag">time</a>, <a href="/tag/macos/" rel="tag">macos</a>

</div>


            <div class="entry">
                
                    <p>Кажется, я понял, из-за чего происходит сбой времени на маке. Дело в истощении
батареи, которая питает часы на материнке. А вот как она истощилась — это
отдельная история.</p>

<p>У меня два мака: корпоративный для работы и личный для ютубов. Два зарядника,
значит. На личном батарея так себе, и ее нужно часто заряжать. Чтобы не таскать
зарядник в офис, я сделал так: соединил рабочий мак с личным по
Type-C. Поскольку рабочий мак на своем заряднике, он снабжает питанием личный
мак. Зарядник для личного лежит дома.</p>

<p>Хорошая идея, но посыпалось она вот на чем. Оказалось, что когда один мак
питается от другого мака, он только питается, а не заряжается. В системном трее
появляется иконка с проводом и вилкой, и если навести мышку, будет написано
“Power Source: Adapter”. Но ниже — “Battery is not charging” — батарея не
заряжается. Ноут как будто становится стационарным компом, который ничего не
знает о батарее.</p>

<p>За неделю батарея истощилась под ноль, хотя внешне это никак не
сказывалось. Когда я отцепил мак от Type-C, он тут же умер. А после тяжелой
перезагрузки полезли глюки со временем. Удаление базы с таймзонами и несколько
циклов заряда не помогли.</p>

<p>Получается вот что: можешь работать от провода, но наполнения батареи не
будет. Тим Кук не одобряет, что на два мака приходится одна зарядка. Не
порядок. Хочешь или нет, понадобится вторая. В качестве побочки — убитая
батарейка, которая питает время.</p>

<p>Посмотрим, подтвердят ли мою догадку в ремонте.</p>

<p>UPD: в комментариях в Телеграме пишут, что бывают зарядки с двумя Type-C
портами. Увы, они расчитаны только для мощного и слабого устройств одновременно,
например макбука и телефона. Два мака одновременно они не тянут.</p>

                
            </div>

        </li>
        
    </ul>

    <h4>
        
        <span class="page_number ">Страница 1 из 83</span>
        
        <a href="/page2" class="next">&rarr;</a>
        
    </h4>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Ivan Grishaev's blog</li>
          <li><a href="mailto:ivan@grishaev.me">ivan@grishaev.me</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
            <li><a href="https://github.com/igrishaev">GitHub</a></li>
            <li><a href="https://t.me/igrishaev_blog">Telegram</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Writing on programming, education, books and negotiations.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
